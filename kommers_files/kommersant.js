/*!
 * kommersant.js
 *
 * © 2020 АО «Коммерсантъ»
 * All rights reserved
 */
"use strict";jQuery.browser||(jQuery.browser={});try{"object"!=typeof window.sessionStorage&&(window.sessionStorage={}),"object"!=typeof window.localStorage&&(window.localStorage={})}catch(ignore){}window.Ya||(window.Ya={}),window.Ya.adfoxCode||(window.Ya.adfoxCode={},window.Ya.adfoxCode.create=function(){},window.Ya.adfoxCode.createAdaptive=function(){},window.Ya.adfoxCode.createScroll=function(){},window.Ya.adfoxCode.reload=function(){}),window.AdFoxBanner||(window.AdFoxBanner=function(){this.createBanner=function(){}}),window.rutarget||(window.rutarget={},window.rutarget.adfox={},window.rutarget.adfox.checkAd=function(){},window.rutarget.adfox.getAdState=function(){}),window.AdFox_getCodeScript||(window.AdFox_getCodeScript=function(){}),window.doc={init:function(options){options&&options.id&&(window.doc.id=parseInt(options.id,10)||-1)}},window.windowOpener=function(w,h,title,url,content){kommersant.utils.windowOpen(url,title,w,h,content)},Object.defineProperty(window,"server_time",{get:function(){return kommersant.getServerDate().valueOf()},set:function(val){kommersant.setServerDateOffset(val)}}),function(){if(window.puidParams&&!window.puids){var i,pair,params=puidParams.split("&");for(window.puids={},i=0;i<params.length;i++)params[i].length&&2===(pair=decodeURIComponent(params[i]).split("=")).length&&(window.puids[pair[0]]=pair[1])}}(),function(kommersant,$){$.extend($.expr[":"],{"really-hidden":function(element){var $element=$(element),recursiveHidden=function($element){return 0!==$element.length&&$element.get(0)!==document.body&&("none"===$element.css("display")||0==$element.css("opacity")||recursiveHidden($element.parent()))};return"hidden"===$element.css("visibility")||recursiveHidden($(element))}});var promiseFixed=null,$window=$(window);this.isWebView=!1,this.windowName="kommersantWindow",this.domain=window.location.hostname.split(".").slice(-2).join("."),this.iHost="https://i.kommersant.ru",this.mainHost="https://"+window.location.host,this.personalHost="https://"+window.location.host,this.serverDateOffset=0,this.lastActivity=new Date,this.media="",this.isTouch="ontouchstart"in window,this.shareCount={vk:0,fb:0,ok:0,lastUpdate:new Date},this.antiCache={},this.bufferedCallbacks={},this.loadPromises={},this.backend={},this.utils={debugDOM:function(element){if("object"!=typeof element||!element.parentNode||element===document.body)return"";var ancestors=this.debugDOM(element.parentNode),classes=element.className.replace(/ /g,".");return(ancestors?ancestors+" > ":"")+element.nodeName+(classes?"."+classes:"")},trim:function(str){return str.replace(/^\s*/,"").replace(/\s*$/,"")},getRandomString:function(){return String(Math.floor(9e8*Math.random()+1e8))},comment:function(html){return"string"!=typeof html?html:html="\x3c!--"+(html=this.trim(html))+"--\x3e"},uncomment:function(html){return"string"!=typeof html||""===html||-1!==(html=this.trim(html)).search(/^<!--[^]*-->$/)&&-1===html.search(/^<!--[^]*(<!--|-->)[^]*-->$/)&&(html=html.replace(/^<!--/,"").replace(/-->$/,""),html=this.trim(html)),html},isEmptyObject:function(obj){var key;for(key in obj)return!1;return!0},objectLength:function(obj){var key,i=0;for(key in obj)i++;return i},inArray:function(needle,haystack){var i;if("object"!=typeof haystack||!(haystack instanceof Array))return!1;for(i=0;i<haystack.length;i++)if(haystack[i]===needle)return!0;return!1},removeElement:function(value,object){var i;if("object"!=typeof object)return!1;if(object instanceof Array)for(i=0;i<object.length;i++)object[i]===value&&object.splice(i--,1);else for(i in object)object[i]===value&&delete object[i]},addUniqueElement:function(value,array){this.inArray(value,array)||array.push(value)},dataBoolean:function(a){return""===a||!!a},dateAdd:function(date,ms){return date.setUTCMilliseconds(date.getUTCMilliseconds()+ms),date},formatNumber:function(number,decimals,decPoint,thousandsSep){if("string"==typeof number){var tmp=parseFloat(number);if(isNaN(tmp))return number;number=tmp}if("number"!=typeof number||isNaN(number))return number;if("number"==typeof decimals&&decimals>=0){decimals=Math.floor(decimals);var pad=Math.pow(10,decimals);number=Math.round(number*pad)/pad}var parts=number.toString().split(".",2),partInteger=parts[0].replace(/^-/,"−"),partFraction=parts[1],result="",n=0;if(Math.abs(number)>=1e4)for(var i=partInteger.length-1;i>=0;i--)result=partInteger[i]+result,3===++n&&i>0&&(n=0,result=("string"==typeof thousandsSep?thousandsSep:" ")+result);else result=partInteger;return void 0!==parts[1]&&(result+=("string"==typeof decPoint?decPoint:",")+partFraction),result},formatDate:function(date){return("0"+date.getDate()).slice(-2)+"."+("0"+(date.getMonth()+1)).slice(-2)+"."+date.getFullYear()},formatTime:function(date){return date.getHours()+":"+("0"+date.getMinutes()).slice(-2)},formatAntiCache:function(date){return("0"+date.getFullYear()).slice(-2)+("0"+(date.getMonth()+1)).slice(-2)+("0"+date.getDate()).slice(-2)+("0"+date.getHours()).slice(-2)+("0"+date.getMinutes()).slice(-2)+("0"+date.getSeconds()).slice(-2)+("00"+date.getMilliseconds()).slice(-3)+"0"},plural:function(n,s1,s2,s5){return(n=Math.abs(n)%100)>=10&&n<=19||0==(n%=10)||n>=5?s5:n>=2?s2:s1},getCookie:function(name){return"string"!=typeof name||""===name?"":decodeURIComponent((document.cookie.match(new RegExp(name+"=([^;]*)"))||["",""])[1])},setCookie:function(name,value,options){if("string"==typeof name&&""!==name){var s=name+"="+encodeURIComponent(value);if("object"==typeof options)for(var i in"object"==typeof options.expires&&(options.expires=options.expires.toUTCString()),options)s="boolean"==typeof options[i]?s+"; "+i:s+"; "+i+"="+options[i];document.cookie=s}},deleteCookie:function(name,options){"object"!=typeof options&&(options={}),options.expires=new Date(0),this.setCookie(name,"",options)},windowOpen:function(url,title,w,h,content){if(window.name===title||kommersant.isWebView)return window.location.href=url,window;var dualScreenLeft=null!=window.screenLeft?window.screenLeft:screen.left,dualScreenTop=null!=window.screenTop?window.screenTop:screen.top,left=(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-w/2+dualScreenLeft,top=(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-h/2+dualScreenTop,newWindow=window.open(url,title,"scrollbars=yes, width="+w+", height="+h+", top="+top+", left="+left);return window.focus&&newWindow.focus(),content&&newWindow.document.write(content),newWindow},loadStyle:function(url){if("string"!=typeof url||""===url)return Promise.reject(new Error("Empty url"));if(kommersant.loadPromises[url])return kommersant.loadPromises[url];var promise=new Promise((function(resolve,reject){if("string"==typeof url&&url.length){var ele=document.createElement("link");ele.onload=resolve,ele.onerror=reject,ele.rel="stylesheet",ele.href=url,ele.charset="utf-8";var links=document.head.getElementsByTagName("link");links[links.length-1].insertAdjacentElement("afterend",ele)}else reject()}));return kommersant.loadPromises[url]=promise},loadScript:function(url,id,isReload){if("string"!=typeof url||""===url)return Promise.reject(new Error("Empty url"));if(!isReload&&kommersant.loadPromises[url])return kommersant.loadPromises[url];var promise=new Promise((function(resolve,reject){if("string"==typeof url&&url.length){var ele=document.createElement("script");ele.onload=resolve,ele.onerror=reject,"string"==typeof id&&""!==id&&(ele.id=id),ele.async=!0,ele.charset="utf-8",ele.src=url;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ele,s)}else reject()}));return isReload?promise:kommersant.loadPromises[url]=promise},applyCallbacks:function(callbacks,param){var i;for(i=0;i<callbacks.length;i++)callbacks[i](param)},triggerCustomEvent:function(element,type,detail){var event,$element;$element="object"==typeof element?$(element):$document,"string"==typeof type&&0!==type.length&&("object"!=typeof detail&&(detail={}),$element.each((function(){try{event=new CustomEvent(type,{bubbles:!0,cancelable:!0,detail:detail}),this.dispatchEvent(event)}catch(err){try{(event=document.createEvent("CustomEvent")).initCustomEvent(type,!0,!0,detail),this.dispatchEvent(event)}catch(err){$(this).trigger(type)}}})))},callBuffered:function(callbackKey,callback,bufferTime,event){callbackKey in kommersant.bufferedCallbacks||(kommersant.bufferedCallbacks[callbackKey]=null),clearTimeout(kommersant.bufferedCallbacks[callbackKey]),kommersant.bufferedCallbacks[callbackKey]=setTimeout(callback,bufferTime||250,event)},swapNodes:function(a,b){var aParent=a.parentNode,aSibling=a.nextSibling===b?a:a.nextSibling;b.parentNode.insertBefore(a,b),aParent.insertBefore(b,aSibling)},checkInViewport:function(elements,appeared,disappeared,callback){var windowScrollTop=$window.scrollTop(),windowHeight=$window.outerHeight();$(elements).each((function(index,ele){var $ele=$(ele),eleOffsetTop=$ele.offset().top,eleHeight=$ele.outerHeight(),wasVisible=!!$ele.data("isInViewport"),isVisible=windowScrollTop+windowHeight>eleOffsetTop&&windowScrollTop<eleOffsetTop+eleHeight&&!$ele.is(":really-hidden");$ele.data("isInViewport",isVisible),!wasVisible&&isVisible&&appeared&&appeared&&appeared.call(ele),wasVisible&&!isVisible&&disappeared&&disappeared&&disappeared.call(ele),callback&&callback.call(ele,isVisible)}))}},this.visitorSegment=window.adSegmentator&&parseInt(window.adSegmentator.getVisitorSegment(2),10)||1,this.getInactivityTime=function(){return new Date-this.lastActivity},this.setServerDateOffset=function(s){this.serverDateOffset=this.parseServerDate(s)-new Date},this.getServerDate=function(){return kommersant.utils.dateAdd(new Date,this.serverDateOffset)},this.parseServerDate=function(s){return new Date("string"==typeof s?parseInt(s.slice(6),10):s)},this.checkOutdated=function(jqXHR,textStatus,errorThrown){return"No Transport"===errorThrown&&(new kommersant.Notification("Ваш браузер устарел. Пожалуйста, обновите его."),!0)},this.updateSocialButtons=function(options){"object"==typeof options&&$(".socials-link").each((function(){var i,$a=$(this),optionsAvailable=["url","picture","quote","title","description"],isChanged=!1;if($a.data("socials-network"))for(i in options)optionsAvailable.indexOf(i)>=0&&(options[i]?$a.data("socials-"+i,options[i]):$a.removeData("socials-"+i),isChanged=!0);isChanged&&kommersant.utils.triggerCustomEvent(this,"kommersant:click")}))},this.advReload=function(selector){$(selector).children('div[id!="adfox_"]').each((function(){try{window.Ya.adfoxCode.reload(this.id)}catch(ignore){}}))},this.sendGA=function(type,category,action,label,value){if("function"==typeof ga)switch(type){case"event":ga("send",type,{eventCategory:category,eventAction:action,eventLabel:label,eventValue:value,transport:"beacon"});break;case"social":ga("send",type,{socialNetwork:category,socialAction:action,socialTarget:label});break;case"exception":ga("send",type,category)}},this.sendYa=function(type,params){if("undefined"!=typeof yaCounter153166)switch(type){case"event":"object"==typeof params&&yaCounter153166.params(params);break;case"goal":"string"==typeof params&&yaCounter153166.reachGoal(params)}},this.sendEvent=function(category,action,label,value){var params;void 0!==category&&(category=""+category),void 0!==action&&(action=""+action),void 0!==label&&(label=""+label),void 0!==value&&(value=parseInt(value,10)||0),category?action?(params={},label?(params[category]={},params[category][action]=void 0!==value?[label,value]:label):params[category]=action):params=[category]:params=[],this.sendGA("event",category,action,label,value),this.sendYa("event",params)},this.ajax=new function(){var self=this;self.promises={},self.storageName="kommersantAjaxCache",self.isLocalStorage=!1,self.collectGarbage=function(){if(self.isLocalStorage){var o,i,isOutdated,date,now;try{localStorage.removeItem("kommersantCachedAjax")}catch(ignore){}try{o=JSON.parse(localStorage.getItem(self.storageName)||"")}catch(err){o={}}if("object"==typeof o)for(i in o)(isOutdated=!1)||void 0!==o[i].type||(isOutdated=!0),isOutdated||void 0===o[i].expires?isOutdated=!0:(date=new Date(o[i].expires),now=new Date,(!date||date<now)&&(isOutdated=!0)),isOutdated&&self.setStorage(i,"","")}},self.getStorage=function(hash,revision){if(!self.isLocalStorage||!hash)return"";var o;try{o=JSON.parse(localStorage.getItem(self.storageName)||"")}catch(err){o={}}if("object"!=typeof o||"object"!=typeof o[hash]||o[hash].revision&&parseInt(o[hash].revision,10)<parseInt(revision,10))return"";var type=o[hash].type||typeof o[hash].data;return function(data,type){switch(type){case"number":return parseFloat(data);case"boolean":return!!data;case"object":try{data=JSON.parse(data)}catch(ignore){data={}}return data;case"undefined":return""}return data}(o[hash].data,type)},self.setStorage=function(hash,revision,data){if(self.isLocalStorage&&hash){var o;try{o=JSON.parse(localStorage.getItem(self.storageName)||"")}catch(err){o={}}var type=typeof data;if("object"==typeof data&&(data=JSON.stringify(data)||""),void 0!==data&&data){var date=new Date;revision?date.setDate(date.getDate()+7):date.setMinutes(date.getMinutes()+5),o[hash]={data:data,type:type,revision:revision,expires:date.valueOf()}}else delete o[hash];try{localStorage.setItem(self.storageName,JSON.stringify(o)||"")}catch(ignore){}}},self.load=function(url,options){var xhr=null;return url={}[url]||url,"object"!=typeof options&&(options={}),void 0===options.cache?options.cache=!0:options.cache=!!options.cache,self.promises[url]||(self.promises[url]=new Promise((function(resolve,reject){var data;if("string"==typeof url&&""!==url){var hash=$.md5(url.replace(/^[^/]*\/{2,}[^/]*kommersant\.ru[^/]*/,"").replace(/\?([0-9]+)$/,"")),revision="",matches=url.match(/\?([0-9]+)$/);matches&&matches[1]&&(revision=matches[1]);if(options.cache&&""!==(data=self.getStorage(hash,revision)))resolve(data);else{var oldSupportCors=$.support.cors;oldSupportCors||($.support.cors=!0),xhr=$.ajax({url:url,method:"GET",success:function(data){self.setStorage(hash,revision,options.cache?data:""),""!==data?resolve(data):reject()},error:function(jqXHR,textStatus,errorThrown){reject(),delete self.promises[url]}}),oldSupportCors||($.support.cors=oldSupportCors)}}else reject()}))),self.promises[url].xhr=xhr,self.promises[url]},self.abort=function(promise){try{promise.xhr&&promise.xhr.abort()}catch(ignore){}},self.init=function(){try{self.isLocalStorage="localStorage"in window&&null!==window.localStorage}catch(ignore){}self.collectGarbage()},self.init()},this.templates=new function(){var self=this;self.data={},self.promises={},self.add=function(name,html){"string"==typeof name&&0!==name.length&&("string"!=typeof html&&(html=""),html=(html=kommersant.utils.uncomment(html)).replace(/^\s+/,"").replace(/\s+$/,"").replace(/\s*\n\s*/g,"\n").replace(/\>\n\<\//g,"></").replace(/\n/g," "),self.data[name]=html)},self.load=function(url,options){return"string"==typeof url&&""!==url||(url=kommersant.antiCache.ajaxTemplates||""),self.promises[url]||(self.promises[url]=kommersant.ajax.load(url,options).then((function(data){var tmp=document.createElement("div");tmp.insertAdjacentHTML("beforeend",data);for(var templates=tmp.querySelectorAll(".template"),i=0;i<templates.length;i++)self.add(templates[i].dataset?templates[i].dataset.templateName:templates[i].getAttribute("data-template-name"),templates[i].innerHTML)}),(function(){}))),self.promises[url]},self.exists=function(templateName){return void 0!==self.data[templateName]},self.apply=function(templateName,vars){if("string"!=typeof templateName||""===templateName)return"";var i,result=self.data[templateName];if(!result)return"";if("object"==typeof vars&&!(vars instanceof Array))for(i in vars)result=result.replace(new RegExp("{{"+i+"}}","g"),vars[i]);return result=result.replace(new RegExp("{{.*?}}","g"),"")}},this.vicons=new function(){var self=this,promise=null,recursive=function(resolve,reject){document.body?resolve():requestAnimationFrame((function(){recursive(resolve,reject)}))};self.supported=!(!document.createElementNS||!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect),self.loaded=[],self.add=function(url,options){if(self.supported&&"string"==typeof url&&""!==url){var pathname=url.split("?")[0].match(/^([^/]*\/{2,}[^/]+)?(.*$)/)[2];self.loaded.indexOf(pathname)>=0||Promise.all([kommersant.ajax.load(url,options),(promise||(promise=new Promise(recursive)),promise)]).then((function(data){"object"!=typeof data||"string"!=typeof data[0]||""===data[0]||self.loaded.indexOf(pathname)>=0||(document.body.insertAdjacentHTML("afterbegin",data[0]),self.loaded.push(pathname))}),(function(){}))}}},this.prepareFixed=function(){return promiseFixed||(promiseFixed=new Promise((function(resolve,reject){kommersant.templates.load().then((function(){$((function(){if(!$(".fixed_bottom").length){var html=kommersant.templates.apply("fixed-bottom");""!==html?$(document.body).append(html):reject()}resolve()}))}),(function(){reject()}))}))),promiseFixed},this.Notification=function(message,options){var self=this;options=$.extend({classes:"",isClosable:!0,autoClose:!0,autoCloseTimeout:3e3,onBeforeShow:function(){},onShow:function(){},onBeforeHide:function(){},onHide:function(){}},options);var $container,$ele,$message,$close,$document=$(document),willClose=!1,handlerKeydown=function(event){27!==event.keyCode||event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||(event.stopImmediatePropagation(),self.close())},handlerTransitionend=function(event){$ele.hide(),$ele.offset(),$ele.show(),self.onShow.call(self)};this.isVisible=!1,this.isHovered=!1,this.isClosing=!1,this.isClosed=!1,this.message=message||"",this.onBeforeShow=options.onBeforeShow,this.onShow=options.onShow,this.onBeforeHide=options.onBeforeHide,this.onHide=options.onHide,this.show=function(){$ele.one("transitionend",handlerTransitionend),$ele.addClass("is_shown"),self.isVisible=!0,self.onBeforeShow.call(self)},this.hide=function(){self.onBeforeHide.call(self),$ele.off("transitionend",handlerTransitionend),$ele.removeClass("is_shown"),self.isVisible=!1},this.close=function(){if(!self.isClosing&&!self.isClosed){self.isClosing=!0;var remove=function(){self.isClosed||($ele.remove(),self.isClosing=!1,self.isClosed=!0,self.onHide.call(self))};$document.off("keydown",handlerKeydown),$ele.on("transitionend",remove),self.hide(),setTimeout(remove,1e3)}},this.init=function(){($container=$(".fixed_bottom__item--notifications")).length||($container=document.body),$ele=$(kommersant.templates.apply("notification",{classes:options.classes,message:this.message,close:options.isClosable?kommersant.templates.apply("notification-close"):""})),$message=$ele.find(".b-notification__message_text"),$close=$ele.find(".b-notification__close"),options.isClosable&&$close.on("click",(function(event){event.preventDefault(),self.close()})),options.autoClose&&setTimeout((function(){self.isHovered?willClose=!0:self.close()}),options.autoCloseTimeout),$document.on("keydown",handlerKeydown),$ele.on("mouseenter",(function(event){self.isHovered=!0})),$ele.on("mouseleave",(function(event){self.isHovered=!1,willClose&&self.close()})),$message.on("click","a",(function(){self.close()})),$ele.prependTo($container),$ele.offset(),self.show()},kommersant.templates.load().then(kommersant.prepareFixed).then((function(){self.init()}),(function(){self.init()}))},this.user=new function(){var ajaxProfileStats,ajaxChangeEmail,ajaxChangePassword,ajaxSocialUnlink,ajaxProfileDelete,ajaxFavoritesUpdate,ajaxSubscriptionsUpdate,user=this,urlSocial=kommersant.iHost+"/user/registersocial",urlProfileInfo=kommersant.iHost+"/user/profileinfomycommon",urlLogoutGlobal=kommersant.iHost+"/user/logout",urlLogoutLocal=kommersant.personalHost+"/lk/logout",urlLogin=kommersant.personalHost+"/lk/login",urlRegister=kommersant.personalHost+"/lk/register",urlProfileStats=kommersant.personalHost+"/lk/profilestats",urlChangeEmail=kommersant.personalHost+"/lk/changeemail",urlChangePassword=kommersant.personalHost+"/lk/changepassword",urlSocialUnlink=kommersant.personalHost+"/lk/profilealiasdelete",urlProfileDelete=kommersant.personalHost+"/lk/profiledelete",urlFavoritesUpdate=kommersant.personalHost+"/lk/bookmarkids",urlFavoritesManage=kommersant.personalHost+"/lk/bookmarkmanage",urlSubscriptionsUpdate=kommersant.personalHost+"/lk/subscriptionids",urlSubscriptionsManage=kommersant.personalHost+"/lk/subscriptionmanage",urlLogHistory=kommersant.personalHost+"/lk/viewhistoryadd",urlCallback=kommersant.personalHost+"/lk/socialcallback",errorCookies="Для входа в личный кабинет включите сохранение файлов cookie",errorAjax="Не удалось подключиться к серверу",cookieUser="kommersantUser",cookiesLocal=["sosh","lkuid"],isInit=!1,lastAuthorized=null,timerCookie=null,timerFavorites=null,timerSubscriptions=null,stringFavoritesDocs="",stringFavoritesGalleries="",stringSubscriptionsThemes="",stringSubscriptionsAuthors="",cookieOptions={domain:"."+kommersant.domain,path:"/"},readyResolve=function(){};this.urlLogout="/",this.urlNotAuthorized="/lk/notauthorized",this.urlProfile="/lk/profile",this.urlProfileEdit="/lk/profileedit",this.urlSubscriptionSettings="/lk/subscriptionsettings",this.urlReferrer="",this.isPagePersonal=!1,this.isPageAuthorizationRequired=!1,this.isPageNotAuthorized=!1,this.isPageUpdateProfile=!1,this.isPageNotificationsUpdate=!1,this.isAuthorized=!1,this.isLogin=!1,this.isLogout=!1,this.project=0,this.data={},this.dataString,this.alias=0,this.favoritesDocs=[],this.favoritesGalleries=[],this.favoritesLocalTime=new Date(0),this.favoritesServerTime="",this.subscriptionsThemes=[],this.subscriptionsAuthors=[],this.subscriptionsLocalTime=new Date(0),this.subscriptionsNotify=!1,this.callbacksAuthorized=[],this.callbacksAlias=[],this.callbacksNotifications=[],this.callbacksFavorites=[],this.callbacksSubscriptions=[],this.callbacksDestroy=[],this.loggedHistory=[],this.socialNetworks={0:"ko",1:"fb",2:"vk",3:"lj",4:"gp",5:"tw",6:"ok",7:"oi"},this.ready=new Promise((function(resolve,reject){readyResolve=resolve})),this.notifications=new function(){var timer,notifications=this,isActive=!1,isUpdating=!1,setTimer=function(){kommersant.getInactivityTime()>=6e5||(clearTimer(),timer=setTimeout((function(){notifications.check()}),997),isActive=!0)},clearTimer=function(){clearTimeout(timer),isActive=!1};this.reset=function(){clearTimer(),this.count=-1},this.clearCookies=function(){kommersant.utils.deleteCookie("kommersantUserNotificationsCount",cookieOptions),kommersant.utils.deleteCookie("kommersantUserNotificationsTimestamp",cookieOptions)},this.check=function(){if(user.isAuthorized&&!isUpdating){clearTimer();var count=parseInt(kommersant.utils.getCookie("kommersantUserNotificationsCount"),10)||0;count!==this.count&&(this.count=count,this.show()),new Date>=kommersant.utils.dateAdd(new Date(parseInt(kommersant.utils.getCookie("kommersantUserNotificationsTimestamp"),10)||0),61101)?this.update():setTimer()}},this.update=function(){if(user.isAuthorized&&!isUpdating){clearTimer(),isUpdating=!0;var cookieOptionsCustom=$.extend({},cookieOptions,{expires:kommersant.utils.dateAdd(new Date,6048e5)});kommersant.utils.setCookie("kommersantUserNotificationsTimestamp",(new Date).valueOf(),cookieOptionsCustom),user.getProfileStats((function(){var count=parseInt(user.stats.SubscriptionNotificationsNew,10)||0;count!==notifications.count&&(notifications.count=count,notifications.show()),kommersant.utils.setCookie("kommersantUserNotificationsCount",notifications.count,cookieOptionsCustom),kommersant.utils.setCookie("kommersantUserNotificationsTimestamp",(new Date).valueOf(),cookieOptionsCustom),setTimer(),isUpdating=!1}),(function(){setTimer(),isUpdating=!1}))}},this.show=function(){kommersant.utils.applyCallbacks(user.callbacksNotifications)},this.init=function(){void 0!==document.hidden?$(document).on("visibilitychange",(function(event){document.hidden?clearTimer():notifications.check()})):($window.on("focus",(function(event){notifications.check()})),$window.on("blur",(function(event){clearTimer()}))),$(document).on("kommersant:useractivity",(function(event){isActive||notifications.check()})),user.isPageNotificationsUpdate?notifications.update():notifications.check()},this.reset()},this.getTypedArray=function(type){switch(type){case 1:return this.favoritesDocs;case 2:return this.favoritesGalleries;case 3:return this.subscriptionsThemes;case 4:return this.subscriptionsAuthors}},this.checkAuthorized=function(code){-50==code&&this.logoutLocal((function(){user.setUser()}))},this.checkCookie=function(){var data,dataString,isLocalAuthorized=!!kommersant.utils.getCookie("kommersantUserIsAuthorized");if(void 0!==(dataString=kommersant.utils.getCookie("kommersantUserNew"))&&""!==dataString){kommersant.utils.deleteCookie("kommersantUserNew",cookieOptions);try{data=JSON.parse(dataString)}catch(err){data={}}if("object"==typeof data)return void(0===data.ErrorCode?data.IsAlias?this.setAlias(data):(this.isLogin=!0,this.setUser(data)):new kommersant.Notification(data.ErrorMessage))}if(!this.isAuthorized||isLocalAuthorized){if(""===(dataString=kommersant.utils.getCookie(cookieUser))&&isLocalAuthorized)return dataString=this.dataString,void this.getProfile(this.project);if(dataString!==this.dataString){this.dataString=dataString;try{data=JSON.parse(dataString)}catch(err){data={}}this.setUser(data,!0)}}else this.setUser()},this.getCookiesFavorites=function(){var i,strDocs=kommersant.utils.getCookie("kommersantUserFavoritesDocs"),strGalleries=kommersant.utils.getCookie("kommersantUserFavoritesGalleries");if(this.favoritesLocalTime=new Date(parseInt(kommersant.utils.getCookie("kommersantUserFavoritesLocalTime"),10)||0),this.favoritesServerTime=kommersant.utils.getCookie("kommersantUserFavoritesServerTime"),strDocs!==stringFavoritesDocs||strGalleries!==stringFavoritesGalleries){for(this.favoritesDocs=strDocs.length>0?strDocs.split("!"):[],this.favoritesGalleries=strGalleries.length>0?strGalleries.split("!"):[],i=0;i<this.favoritesDocs.length;i++)this.favoritesDocs[i]=parseInt(this.favoritesDocs[i],10)||0;for(i=0;i<this.favoritesGalleries.length;i++)this.favoritesGalleries[i]=parseInt(this.favoritesGalleries[i],10)||0;stringFavoritesDocs=strDocs,stringFavoritesGalleries=strGalleries,kommersant.utils.applyCallbacks(this.callbacksFavorites)}},this.getCookiesSubscriptions=function(){var i,strThemes=kommersant.utils.getCookie("kommersantUserSubscriptionsThemes"),strAuthors=kommersant.utils.getCookie("kommersantUserSubscriptionsAuthors");if(this.subscriptionsNotify=!!kommersant.utils.getCookie("kommersantUserSubscriptionsNotify"),this.subscriptionsLocalTime=new Date(parseInt(kommersant.utils.getCookie("kommersantUserSubscriptionsLocalTime"),10)||0),strThemes!==stringSubscriptionsThemes||strAuthors!==stringSubscriptionsAuthors){for(this.subscriptionsThemes=strThemes.length>0?strThemes.split("!"):[],this.subscriptionsAuthors=strAuthors.length>0?strAuthors.split("!"):[],i=0;i<this.subscriptionsThemes.length;i++)this.subscriptionsThemes[i]=parseInt(this.subscriptionsThemes[i],10)||0;for(i=0;i<this.subscriptionsAuthors.length;i++)this.subscriptionsAuthors[i]=parseInt(this.subscriptionsAuthors[i],10)||0;stringSubscriptionsThemes=strThemes,stringSubscriptionsAuthors=strAuthors,kommersant.utils.applyCallbacks(this.callbacksSubscriptions)}},this.setCookiesFavorites=function(){var cookieOptionsCustom=$.extend({},cookieOptions,{expires:kommersant.utils.dateAdd(new Date,6048e5)});kommersant.utils.setCookie("kommersantUserFavoritesDocs",this.favoritesDocs.join("!"),cookieOptionsCustom),kommersant.utils.setCookie("kommersantUserFavoritesGalleries",this.favoritesGalleries.join("!"),cookieOptionsCustom),kommersant.utils.setCookie("kommersantUserFavoritesLocalTime",this.favoritesLocalTime.valueOf(),cookieOptionsCustom),kommersant.utils.setCookie("kommersantUserFavoritesServerTime",this.favoritesServerTime,cookieOptionsCustom)},this.setCookiesSubscriptions=function(){var cookieOptionsCustom=$.extend({},cookieOptions,{expires:kommersant.utils.dateAdd(new Date,6048e5)});kommersant.utils.setCookie("kommersantUserSubscriptionsThemes",this.subscriptionsThemes.join("!"),cookieOptionsCustom),kommersant.utils.setCookie("kommersantUserSubscriptionsAuthors",this.subscriptionsAuthors.join("!"),cookieOptionsCustom),kommersant.utils.setCookie("kommersantUserSubscriptionsLocalTime",this.subscriptionsLocalTime.valueOf(),cookieOptionsCustom),kommersant.utils.setCookie("kommersantUserSubscriptionsNotify",this.subscriptionsNotify?"1":"",cookieOptionsCustom)},this.clearFavorites=function(){clearTimeout(timerFavorites),this.favoritesDocs=[],this.favoritesGalleries=[],this.favoritesLocalTime=new Date(0),this.favoritesServerTime="",kommersant.utils.deleteCookie("kommersantUserFavoritesDocs",cookieOptions),kommersant.utils.deleteCookie("kommersantUserFavoritesGalleries",cookieOptions),kommersant.utils.deleteCookie("kommersantUserFavoritesLocalTime",cookieOptions),kommersant.utils.deleteCookie("kommersantUserFavoritesServerTime",cookieOptions)},this.clearSubscriptions=function(){clearTimeout(timerSubscriptions),this.subscriptionsThemes=[],this.subscriptionsAuthors=[],this.subscriptionsLocalTime=new Date(0),kommersant.utils.deleteCookie("kommersantUserSubscriptionsThemes",cookieOptions),kommersant.utils.deleteCookie("kommersantUserSubscriptionsAuthors",cookieOptions),kommersant.utils.deleteCookie("kommersantUserSubscriptionsLocalTime",cookieOptions),kommersant.utils.deleteCookie("kommersantUserSubscriptionsNotify",cookieOptions)},this.setUser=function(data,noSetCookie){var dataString,i;if(this.isAuthorized="object"==typeof data&&0===data.ErrorCode&&1===data.Status,this.isAuthorized?data.Rating=parseInt(data.Rating,10)||0:data={},this.data=data,!noSetCookie){try{dataString=JSON.stringify(data)}catch(err){dataString="{}"}if(kommersant.utils.setCookie(cookieUser,dataString,$.extend({},cookieOptions,{expires:kommersant.utils.dateAdd(new Date,this.isAuthorized||kommersant.utils.getCookie("kommersantUserEverAuthorized")?36e5:31536e6)})),this.dataString=kommersant.utils.getCookie(cookieUser),this.dataString!==dataString)return new kommersant.Notification(errorCookies),void this.destroy();this.isAuthorized?kommersant.utils.setCookie("kommersantUserEverAuthorized",1,$.extend({},cookieOptions,{expires:kommersant.utils.dateAdd(new Date,31536e6)})):(kommersant.utils.deleteCookie("kommersantUserIsAuthorized",cookieOptions),this.notifications.clearCookies(),this.clearFavorites(),this.clearSubscriptions())}if(this.isAuthorized?(this.notifications.check(),this.favoritesUpdate(),this.subscriptionsUpdate()):(this.favoritesDocs=[],this.favoritesGalleries=[],this.subscriptionsThemes=[],this.subscriptionsAuthors=[],this.notifications.reset()),!(this.isAuthorized||null!==lastAuthorized&&noSetCookie))for(i=0;i<cookiesLocal.length;i++)kommersant.utils.deleteCookie(cookiesLocal[i],cookieOptions);if(kommersant.utils.applyCallbacks(this.callbacksAuthorized),kommersant.utils.applyCallbacks(this.callbacksFavorites),kommersant.utils.applyCallbacks(this.callbacksSubscriptions),this.isAuthorized){if(this.isPageNotAuthorized){if(window.name!==kommersant.windowName||kommersant.isWebView)return window.location.replace(this.urlReferrer||this.urlProfile),void this.destroy();window.open("","_self"),window.close()}else if(this.isPagePersonal&&!1===lastAuthorized)return window.location.reload(),void this.destroy()}else{if(this.isPageAuthorizationRequired)return this.isLogout&&!kommersant.isWebView?window.location.href=this.urlLogout:window.location.replace(this.urlNotAuthorized+"?r="+encodeURIComponent(window.location.pathname+window.location.search)),void this.destroy();if(this.isPagePersonal&&!0===lastAuthorized)return window.location.reload(),void this.destroy()}lastAuthorized=this.isAuthorized,this.isLogin=!1,this.isLogout=!1,readyResolve()},this.setAlias=function(data){"object"!=typeof data||0!==data.ErrorCode||"number"!=typeof data.SocialNetworkAlias&&data.SocialNetworkAlias<=0||(this.alias=data.SocialNetworkAlias,kommersant.utils.applyCallbacks(this.callbacksAlias),this.alias=0)},this.login=function(){kommersant.utils.windowOpen(urlLogin,kommersant.windowName,800,680)},this.register=function(){kommersant.utils.windowOpen(urlRegister,kommersant.windowName,800,680)},this.social=function(project,socialNetwork,isAlias){var data={project:project,socialNetwork:socialNetwork,isAlias:isAlias,callbackUrl:urlCallback};kommersant.utils.windowOpen(urlSocial+"?"+$.param(data),kommersant.windowName,800,680)},this.logout=function(){var count=2,callback=function(){--count>0||(user.isLogout=!0,user.setUser())};this.logoutGlobal(callback),this.logoutLocal(callback)},this.logoutGlobal=function(callback){var options={xhrFields:{withCredentials:!0},url:urlLogoutGlobal,method:"POST"};void 0!==callback&&(options.complete=function(){callback()}),$.ajax(options)},this.logoutLocal=function(callback){var options={xhrFields:{withCredentials:!0},url:urlLogoutLocal,method:"POST"};void 0!==callback&&(options.complete=function(){callback()}),$.ajax(options)},this.getProfile=function(project,success,error){success=success||function(){},error=error||function(){},$.ajax({xhrFields:{withCredentials:!0},url:urlProfileInfo,method:"POST",data:{project:project},success:function(data){user.setUser(data),"object"==typeof data?0===data.ErrorCode?success():error(data.ErrorMessage):error(errorAjax)},error:function(jqXHR,textStatus,errorThrown){user.setUser(),kommersant.checkOutdated.apply(null,arguments)||error(errorAjax)}})},this.updateProfile=function(){kommersant.utils.deleteCookie(cookieUser,cookieOptions)},this.getProfileStats=function(success,error){if(this.isAuthorized){success=success||function(){},error=error||function(){};try{ajaxProfileStats.abort()}catch(ignore){}ajaxProfileStats=$.ajax({xhrFields:{withCredentials:!0},url:urlProfileStats,method:"POST",success:function(data){"object"==typeof data?0===data.ErrorCode?(user.stats=data,user.data.Rating=parseInt(data.Rating,10)||0,success()):(error(data.ErrorMessage),user.checkAuthorized(data.ErrorCode)):error(errorAjax)},error:function(jqXHR,textStatus,errorThrown){error(errorAjax)}})}},this.changeEmail=function(email,success,error){if(this.isAuthorized){success=success||function(){},error=error||function(){};try{ajaxChangeEmail.abort()}catch(ignore){}ajaxChangeEmail=$.ajax({xhrFields:{withCredentials:!0},url:urlChangeEmail,method:"POST",data:{email:email},success:function(data){"object"==typeof data?0===data.ErrorCode?success():(error(data.ErrorMessage),user.checkAuthorized(data.ErrorCode)):error(errorAjax)},error:function(jqXHR,textStatus,errorThrown){kommersant.checkOutdated.apply(null,arguments)||error(errorAjax)}})}},this.changePassword=function(oldPassword,newPassword,success,error){if(this.isAuthorized){success=success||function(){},error=error||function(){};try{ajaxChangePassword.abort()}catch(ignore){}ajaxChangePassword=$.ajax({xhrFields:{withCredentials:!0},url:urlChangePassword,method:"POST",data:{oldPassword:oldPassword,newPassword:newPassword},success:function(data){"object"==typeof data?0===data.ErrorCode?success():(error(data.ErrorMessage),user.checkAuthorized(data.ErrorCode)):error(errorAjax)},error:function(jqXHR,textStatus,errorThrown){kommersant.checkOutdated.apply(null,arguments)||error(errorAjax)}})}},this.socialUnlink=function(socialNetwork,success,error){if(this.isAuthorized){success=success||function(){},error=error||function(){};try{ajaxSocialUnlink.abort()}catch(ignore){}ajaxSocialUnlink=$.ajax({xhrFields:{withCredentials:!0},url:urlSocialUnlink,method:"POST",data:{socialNetwork:socialNetwork},success:function(data){"object"==typeof data?0===data.ErrorCode?success():(error(data.ErrorMessage),user.checkAuthorized(data.ErrorCode)):error(errorAjax)},error:function(jqXHR,textStatus,errorThrown){kommersant.checkOutdated.apply(null,arguments)||error(errorAjax)}})}},this.profileDelete=function(password,success,error){if(this.isAuthorized){success=success||function(){},error=error||function(){};try{ajaxProfileDelete.abort()}catch(ignore){}ajaxProfileDelete=$.ajax({xhrFields:{withCredentials:!0},url:urlProfileDelete,method:"POST",data:{password:password},success:function(data){"object"==typeof data?0===data.ErrorCode?(success(),user.logout()):(error(data.ErrorMessage),user.checkAuthorized(data.ErrorCode)):error(errorAjax)},error:function(jqXHR,textStatus,errorThrown){kommersant.checkOutdated.apply(null,arguments)||error(errorAjax)}})}},this.favoritesUpdate=function(){if(clearTimeout(timerFavorites),this.isAuthorized){var setTimer=function(){timerFavorites=setTimeout((function(){user.favoritesUpdate()}),997)};if(this.getCookiesFavorites(),this.favoritesLocalTime<kommersant.utils.dateAdd(new Date,-577577)){this.favoritesLocalTime=new Date,this.setCookiesFavorites();try{ajaxFavoritesUpdate.abort()}catch(ignore){}ajaxFavoritesUpdate=$.ajax({xhrFields:{withCredentials:!0},url:urlFavoritesUpdate,method:"POST",data:{lastDateUpdate:user.favoritesServerTime},success:function(data){var i;if("object"==typeof data&&0===data.ErrorCode){if("object"==typeof data.Objects&&data.Objects instanceof Array)for(i=0;i<data.Objects.length;i++)data.Objects[i].Bookmark?kommersant.utils.addUniqueElement(data.Objects[i].Id,user.getTypedArray(data.Objects[i].ObjectType)):kommersant.utils.removeElement(data.Objects[i].Id,user.getTypedArray(data.Objects[i].ObjectType));user.favoritesLocalTime=new Date,user.favoritesServerTime=data.DateUpdate,user.setCookiesFavorites(),kommersant.utils.applyCallbacks(user.callbacksFavorites)}},complete:function(){setTimer()}})}else setTimer()}},this.subscriptionsUpdate=function(isForce){if(clearTimeout(timerSubscriptions),this.isAuthorized){var setTimer=function(){timerSubscriptions=setTimeout((function(){user.subscriptionsUpdate()}),997)};if(this.getCookiesSubscriptions(),isForce||this.subscriptionsLocalTime<kommersant.utils.dateAdd(new Date,-599599)){this.subscriptionsLocalTime=new Date,this.setCookiesSubscriptions();try{ajaxSubscriptionsUpdate.abort()}catch(ignore){}ajaxSubscriptionsUpdate=$.ajax({xhrFields:{withCredentials:!0},url:urlSubscriptionsUpdate,method:"POST",success:function(data){var i;if("object"==typeof data&&0===data.ErrorCode){if("object"==typeof data.Objects&&data.Objects instanceof Array)for(user.subscriptionsThemes=[],user.subscriptionsAuthors=[],i=0;i<data.Objects.length;i++)user.getTypedArray(data.Objects[i].ObjectType).push(data.Objects[i].Id);user.subscriptionsNotify=!!data.NotifySubscription,user.subscriptionsLocalTime=new Date,user.setCookiesSubscriptions(),kommersant.utils.applyCallbacks(user.callbacksSubscriptions)}},complete:function(){setTimer()}})}else setTimer()}},this.favoritesManage=function(id,type,isDelete,success,error){success=success||function(){},error=error||function(){},this.isAuthorized&&$.ajax({xhrFields:{withCredentials:!0},url:urlFavoritesManage,method:"POST",data:{objectIds:id,objectType:type,delete:!!isDelete},success:function(data){"object"==typeof data?0===data.ErrorCode?(isDelete?kommersant.utils.removeElement(id,user.getTypedArray(type)):kommersant.utils.addUniqueElement(id,user.getTypedArray(type)),user.setCookiesFavorites(),kommersant.utils.applyCallbacks(user.callbacksFavorites),success()):(error(data.ErrorMessage),user.checkAuthorized(data.ErrorCode),kommersant.utils.applyCallbacks(user.callbacksFavorites)):(error(errorAjax),kommersant.utils.applyCallbacks(user.callbacksFavorites))},error:function(jqXHR,textStatus,errorThrown){kommersant.checkOutdated.apply(null,arguments)||error(errorAjax),kommersant.utils.applyCallbacks(user.callbacksFavorites)}})},this.subscriptionsManage=function(id,type,isDelete,success,error){success=success||function(){},error=error||function(){},this.isAuthorized&&$.ajax({xhrFields:{withCredentials:!0},url:urlSubscriptionsManage,method:"POST",data:{objectIds:id,objectType:type,delete:!!isDelete},success:function(data){"object"==typeof data?0===data.ErrorCode?(user.getCookiesSubscriptions(),isDelete?kommersant.utils.removeElement(id,user.getTypedArray(type)):kommersant.utils.addUniqueElement(id,user.getTypedArray(type)),user.setCookiesSubscriptions(),kommersant.utils.applyCallbacks(user.callbacksSubscriptions),success()):(error(data.ErrorMessage),user.checkAuthorized(data.ErrorCode),kommersant.utils.applyCallbacks(user.callbacksSubscriptions)):(error(errorAjax),kommersant.utils.applyCallbacks(user.callbacksSubscriptions))},error:function(jqXHR,textStatus,errorThrown){kommersant.checkOutdated.apply(null,arguments)||error(errorAjax),kommersant.utils.applyCallbacks(user.callbacksSubscriptions)}})},this.logHistory=function(id,type,success,error){!this.isAuthorized||this.loggedHistory.indexOf(id)>=0||void 0===id||void 0===type||(success=success||function(){},error=error||function(){},this.loggedHistory.push(id),$.ajax({xhrFields:{withCredentials:!0},url:urlLogHistory,method:"POST",data:{objectIds:id,objectType:type},success:function(data){"object"==typeof data?0===data.ErrorCode?success():(error(data.ErrorMessage),user.checkAuthorized(data.ErrorCode)):error(errorAjax)},error:function(jqXHR,textStatus,errorThrown){error(errorAjax)}}))},this.cookiesEnabled=function(){var dataString;return""!==(dataString=kommersant.utils.getCookie(cookieUser))||(kommersant.utils.setCookie("kommersantTest","1",$.extend({},cookieOptions,{expires:kommersant.utils.dateAdd(new Date,1e4)})),dataString=kommersant.utils.getCookie("kommersantTest"),kommersant.utils.deleteCookie("kommersantTest",cookieOptions),""!==dataString)},this.init=function(project){if(!isInit){if(isInit=!0,!this.cookiesEnabled())return new kommersant.Notification(errorCookies),void this.destroy();this.project=project,(this.isPageNotAuthorized||this.isPageUpdateProfile)&&this.updateProfile(),timerCookie=setInterval((function(){user.checkCookie()}),211),this.checkCookie(),this.notifications.init(),this.isAuthorized&&"undefined"!=typeof objId&&"undefined"!=typeof objType&&this.logHistory(objId,objType)}},this.destroy=function(){isInit&&(clearInterval(timerCookie),this.notifications.reset(),isInit=!1,kommersant.utils.applyCallbacks(this.callbacksDestroy))}}}.call(window.kommersant={},kommersant,jQuery),kommersant.utils.getCookie("_a_d3t6sf")&&(kommersant.utils.deleteCookie("_a_d3t6sf"),kommersant.utils.deleteCookie("_a_d3t6sf",{path:"/"}),kommersant.utils.deleteCookie("_a_d3t6sf",{domain:window.location.host}),kommersant.utils.deleteCookie("_a_d3t6sf",{domain:window.location.host,path:"/"}),kommersant.utils.deleteCookie("_a_d3t6sf",{domain:"www.kommersant.ru"}),kommersant.utils.deleteCookie("_a_d3t6sf",{domain:"www.kommersant.ru",path:"/"}),kommersant.utils.deleteCookie("_a_d3t6sf",{domain:"kommersant.ru"}),kommersant.utils.deleteCookie("_a_d3t6sf",{domain:"kommersant.ru",path:"/"}),kommersant.utils.deleteCookie("_a_d3t6sf",{domain:".kommersant.ru"}),kommersant.utils.deleteCookie("_a_d3t6sf",{domain:".kommersant.ru",path:"/"})),function($){var $window=$(window),$document=$(document),$html=$(document.documentElement),isMouseFired=!1,isTouchFired=!1,gHisrcPush=function(){};$html.removeClass("no-js"),"KommersantApp"===navigator.userAgent?(kommersant.isWebView=!0,$html.addClass("webview")):kommersant.isWebView=$html.hasClass("webview"),""==$html.attr("class")&&$html.removeAttr("class"),void 0!==$.scrollTo&&$.extend($.scrollTo.defaults,{axis:"y",duration:500,interrupt:!0,fail:function(animation){$(animation.elem).scrollTop(animation.props.scrollTop)}}),kommersant.isTouch&&$((function(){$(document.body).addClass("touch")})),$window.one("mousemove",(function(event){isMouseFired=!0,!isTouchFired&&kommersant.isTouch&&($((function(){$(document.body).removeClass("touch")})),kommersant.isTouch=!1)})),$window.one("touchstart",(function(event){isTouchFired=!0,isMouseFired||kommersant.isTouch||($((function(){$(document.body).addClass("touch")})),kommersant.isTouch=!0)})),window.canonical=[],window.kommersantInit=function(){},window.getDocsId=function(){return"number"==typeof window.docsId?window.docsId:parseInt((window.location.pathname.match(/^\/(doc|gallery)\/(\d+)/)||["","","0"])[2],10)},window.hisrcCached=function(hisrc){var s;try{return"string"==typeof(s=localStorage.getItem("kommersantHisrc"))&&-1!==s.indexOf($.md5(hisrc))}catch(err){return!1}},window.lowsrc=function(){},$document.on("smi2Loaded",(function(event){var $slider=$(event.target).closest(".slider");1===$slider.length&&($slider.addClass("slider-involve"),kommersantInit())})),$((function(){var $head=$(document.head),$body=$(document.body),$root=void 0!==window.onmousemove?$window:$document,$darkbox=$(),isTooltipInitialized=!1;gHisrcPush=function(hisrc){var i,md5=$.md5(hisrc),s="",a=[];try{s=localStorage.getItem("kommersantHisrc")||""}catch(err){return}"string"!=typeof s&&(s=""),""!==s&&(i=(a=s.split(" ")).indexOf(md5))>=0&&a.splice(i,1),a.unshift(md5),a.length>1e3&&(a.length=1e3),s=a.join(" ");try{localStorage.setItem("kommersantHisrc",s)}catch(ignore){}};var timerInterval,timerEnd,isOn,resizeFunction,lastActivity,lastReported,handler,loadSource,checkForceIfVisible,dataFired,reInit,error,update,handlerKeydown,refresh,close,getDuration,$additional,selectOnChange,cookieOptions,$fullversion,onClick,gImgSrcset=function(img,namespace,onload,onerror){var $img=$(img),srcset=$img.data(namespace+"-srcset")||"",src=$img.data(namespace+"-src")||"";onload&&$img.on("load",(function(){onload.call(this)})),onerror&&$img.on("error",(function(){onerror.call(this)})),""!=srcset&&$img.attr("srcset",srcset),""!=src&&$img.attr("src",src),$img.removeData([namespace+"-srcset",namespace+"-src"]),$img.removeAttr("data-"+namespace+"-srcset data-"+namespace+"-src")},gHisrcLoadVisible=function(context){kommersant.utils.checkInViewport($(".hisrc:visible",context),(function(){var img,dataKey,$img,hisrc;dataKey="hisrc",$img=$(img=this),""!=(hisrc=$img.data(dataKey)||"")&&(img.src=hisrc,gHisrcPush(hisrc)),$img.removeData(dataKey),$img.removeClass("hisrc")}))},loadRecommended=function(block){var $stickyLeftSticky=$("#stickyLeft .sticky");$stickyLeftSticky.empty(),Math.random()<.5?function(){var unitId="85687";if(window.docInfo&&window.docInfo.publishing&&window.docInfo.publishing.id){var publisherID=window.docInfo.publishing.id;14==publisherID&&(unitId="92293"),284!=publisherID&&285!=publisherID||(unitId="89003")}$stickyLeftSticky.append('<div id="unit_'+unitId+'"></div>'),kommersant.utils.loadScript("//news.smi2.ru/data/js/"+unitId+".js",null,!0).catch((function(){}))}():Math.random()<.5?function(){var id="infox_21917";$stickyLeftSticky.append('<div id="'+id+'"></div>');var property="infoxContextAsyncCallbacks21917";window[property]=window[property]||[],window[property].push((function(){INFOX21917.renderTo(id)})),kommersant.utils.loadScript("//rb.infox.sg/infox/21917",null,!0).catch((function(){}))}():($stickyLeftSticky.append('<div id="M465403ScriptRootC977147"></div>'),kommersant.utils.loadScript("https://jsc.lentainform.com/k/o/kommersant.ru.977147.js",null,!0).catch((function(){})))};loadRecommended(),window.kommersantInit=function(){var docsId=getDocsId();"function"==typeof $.fn.slider&&($(".slider-custom").not(".slider-ready").each((function(){var $slider=$(this),$sliderItem=$slider.find(".slider-item");if(0!==$sliderItem.length){var timerHover,$progress=$slider.find(".slider-custom-progress"),$resizable=$slider.find(".slider-custom-resizable"),isInfo=!0,images=[],currentItem=0,currentId=1,onReady=$slider.data("slider-onready")||"",onLeave=$slider.data("slider-onleave")||"",onChange=$slider.data("slider-onchange")||"",onComplete=$slider.data("slider-oncomplete")||"",onClick=$slider.data("slider-onclick")||"",onMostlyVisible=$slider.data("slider-onmostlyvisible")||"",onMostlyInvisible=$slider.data("slider-onmostlyinvisible")||"",isHash=kommersant.utils.dataBoolean($slider.data("slider-custom-hash")),isHistory=isHash&&kommersant.utils.dataBoolean($slider.data("slider-custom-history")),isCounters=kommersant.utils.dataBoolean($slider.data("slider-custom-counters")),preloadBackward=parseInt($slider.data("slider-custom-preload-backward"),10),preloadForward=parseInt($slider.data("slider-custom-preload-forward"),10),minItems=parseInt($slider.data("slider-custom-minitems"),10);isNaN(preloadBackward)&&(preloadBackward=1),isNaN(preloadForward)&&(preloadForward=2),isNaN(minItems)&&(minItems=2),$sliderItem.length<minItems&&($progress.remove(),$slider.find(".slider-prev, .slider-next, .slider-nav").css("visibility","hidden"));var param,preload=function(index,id){var hisrc=function(index){for(var i=0;images[index]&&i<images[index].length;i++)void 0!==images[index][i]&&(gImgSrcset(images[index][i],"slider"),delete images[index][i])};kommersant.utils.checkInViewport($slider,null,null,(function(isVisible){if(isVisible){hisrc(index);for(var i=1;i<=Math.max(preloadBackward,preloadForward);i++)i<=preloadForward&&hisrc(index+i),i<=preloadBackward&&hisrc(index-i)}}))},resize=function(index,id){var selectors=[".js-gallery-resizable-item-current",".slider-item-current",".slider-nav-item-current"];$resizable.each((function(){for(var $resizable=$(this),$current=$(),i=0;i<selectors.length&&!$current.length;i++)$current=$resizable.find(selectors[i]);$resizable.css("height",$current.outerHeight(!0)||0)}))},options={isKeyboard:!0,margin:30,onReady:function(index,id){currentItem=index,currentId=id,preload(index),$window.on("resize scroll",(function(){kommersant.utils.checkInViewport($slider,(function(){preload(currentItem)}))})),$resizable.length>0&&($window.on("kommersant:resize",(function(event){resize()})),document.addEventListener("load",(function(event){resize()}),!0),resize(),$resizable.css({overflow:"hidden",height:0,transition:"height 400ms ease"})),timerHover=setTimeout((function(){$slider.addClass("slider-hover")}),500),""!==onReady&&void 0!==window[onReady]&&window[onReady].call(this,index,id)},onLeave:function(index,id){""!==onLeave&&void 0!==window[onLeave]&&window[onLeave].call(this,index,id)},onChange:function(index,id,reason){""!==onChange&&void 0!==window[onChange]&&window[onChange].call(this,index,id,reason)},onComplete:function(index,id){if(index!=currentItem){if(isHash&&function(index,id){var hash="#id="+id;window.location.hash!=hash&&(isHistory?"pushState"in history?history.pushState(null,null,hash):window.location=hash:"replaceState"in history?history.replaceState(null,null,hash):window.location.replace(hash))}(0,id),preload(index),resize(),isCounters)try{countersUpdate()}catch(ignore){}currentItem=index,currentId=id,setTimeout((function(){$window.trigger("scroll")}),100),""!==onComplete&&void 0!==window[onComplete]&&window[onComplete].call(this,index,id)}},onPseudoClick:function(index,id){clearTimeout(timerHover),(isInfo=!isInfo)?$slider.addClass("slider-hover"):$slider.removeClass("slider-hover"),""!==onClick&&void 0!==window[onClick]&&window[onClick].call(this,index,id)},onMostlyVisible:function(index,id){""!==onMostlyVisible&&void 0!==window[onMostlyVisible]&&window[onMostlyVisible].call(this,index,id)},onMostlyInvisible:function(index,id){""!==onMostlyInvisible&&void 0!==window[onMostlyInvisible]&&window[onMostlyInvisible].call(this,index,id)}};$progress.length>0&&(options.onStep=function(offset,canvasSize,itemsSize,progress,stepPart){stepPart=Math.max(.05,stepPart),progress>1&&(progress=1),progress<=0&&(progress=0),$progress.css("transform","translateX("+(progress*(1-stepPart)*100).toFixed(2)+"%) scaleX("+stepPart.toFixed(4)+")")}),void 0!==(param=$slider.data("slider-start"))?options.start=param:isHash&&(options.start=window.location.hash.slice(4)||1),void 0!==(param=$slider.data("slider-margin"))&&(options.margin=parseFloat(param)||0),void 0!==(param=$slider.data("slider-align"))&&(options.align=parseFloat(param),isNaN(options.align)&&(options.align=.5)),void 0!==(param=$slider.data("slider-duration"))&&(options.durationItem=parseInt(param,10)||0),void 0!==(param=$slider.data("slider-fade"))&&(options.fade=parseFloat(param),isNaN(options.fade)&&(options.fade=1)),kommersant.utils.dataBoolean($slider.data("slider-nokeys"))&&(options.isKeyboard=!1),kommersant.utils.dataBoolean($slider.data("slider-vertical"))&&(options.isVertical=!0),kommersant.utils.dataBoolean($slider.data("slider-loop"))&&(options.isLooped=!0),kommersant.utils.dataBoolean($slider.data("slider-auto"))&&(options.isAutoSlide=!0),void 0!==(param=$slider.data("slider-auto-delay"))&&(options.autoSlideInterval=parseInt(param,10)||0),kommersant.utils.dataBoolean($slider.data("slider-nodrag"))&&(options.isDraggable=!1),kommersant.utils.dataBoolean($slider.data("slider-notransform"))&&(options.isTransform=!1),kommersant.utils.dataBoolean($slider.data("slider-notransform3d"))&&(options.isTransform3d=!1),kommersant.utils.dataBoolean($slider.data("slider-fit"))&&(options.isFit=!0),$sliderItem.each((function(i){images[i]=[],$(this).find(".slider-custom-img").each((function(j){images[i][j]=this})),0===images[i].length&&$(this).find("img").first().each((function(j){""!=($(this).data("slider-src")||"")&&(images[i][j]=this)}))})),$slider.slider(options),isHash&&$window.on("hashchange",(function(event){var id=window.location.hash.slice(4)||1;id!==currentId&&(event.preventDefault(),$slider.slider("goTo",id))}))}else $slider.addClass("slider-ready")})),$(".slider-scroll").not(".slider-ready").each((function(){var $slider=$(this),$sliderItem=$slider.find(".slider-item");if($sliderItem.each((function(){var $item=$(this);$item.data("docsid")==docsId&&$item.remove()})),0!==$sliderItem.length){var $progress=$slider.find(".slider-scroll-progress");$slider.slider({isFit:!0,isMomentum:!0,align:0,margin:30,onStep:function(offset,canvasSize,itemsSize,progress,stepPart){stepPart=Math.max(.05,stepPart),progress>1&&(progress=1),progress<=0&&(progress=0),$progress.css("transform","translateX("+(progress*(1-stepPart)*100).toFixed(2)+"%) scaleX("+stepPart.toFixed(4)+")")}})}else $slider.addClass("slider-ready")})),$(".slider-announce").not(".slider-ready").each((function(){var $slider=$(this),$sliderItem=$slider.find(".slider-item");if(0!==$sliderItem.length){var $progress=$slider.find(".slider-announce-progress");1===$sliderItem.length&&($progress.remove(),$slider.find(".slider-prev, .slider-next, .slider-nav").css("visibility","hidden"));var images=[],currentItem=0,preload=function(index,id){var hisrc=function(index){for(var i=0;images[index]&&i<images[index].length;i++)void 0!==images[index][i]&&(gImgSrcset(images[index][i],"slider"),delete images[index][i])};kommersant.utils.checkInViewport($slider,null,null,(function(isVisible){isVisible&&(hisrc(index),hisrc(index+1))}))},options={isTransform3d:!1,isLooped:!0,isAutoSlide:!0,margin:20,autoSlideInterval:5e3,onReady:function(index,id){currentItem=index,preload(index),$window.on("resize scroll",(function(){kommersant.utils.checkInViewport($slider,(function(){preload(currentItem)}))}))},onComplete:function(index,id){index!=currentItem&&(preload(index),currentItem=index)}};$progress.length>0&&(options.onStep=function(offset,canvasSize,itemsSize,progress,stepPart){stepPart=Math.max(.05,stepPart),$progress.each((function(index){$(this).css("transform","translateX("+(100*(progress*(1-stepPart)-index)).toFixed(2)+"%) scaleX("+stepPart.toFixed(4)+")")}))}),$sliderItem.each((function(i){images[i]=[],$(this).find(".slider-announce-img").each((function(j){images[i][j]=this}))})),$slider.slider(options)}else $slider.addClass("slider-ready")})),$(".slider-specials").not(".slider-ready").each((function(){var $slider=$(this),$sliderItem=$slider.find(".slider-item");if(0!==$sliderItem.length){var $progress=$slider.find(".slider-specials-progress");1===$sliderItem.length&&($progress.remove(),$slider.find(".slider-prev, .slider-next, .slider-nav").css("visibility","hidden"));var images=[],currentItem=0,preload=function(index,id){var hisrc=function(index){for(var i=0;images[index]&&i<images[index].length;i++)void 0!==images[index][i]&&(gImgSrcset(images[index][i],"slider"),delete images[index][i])};kommersant.utils.checkInViewport($slider,null,null,(function(isVisible){isVisible&&(hisrc(index),hisrc(index+1))}))},options={isKeyboard:!0,isLooped:!0,isAutoSlide:!0,margin:30,autoSlideInterval:5e3,onReady:function(index,id){currentItem=index,preload(index),$window.on("resize scroll",(function(){kommersant.utils.checkInViewport($slider,(function(){preload(currentItem)}))}))},onComplete:function(index,id){index!=currentItem&&(preload(index),currentItem=index)}};$progress.length>0&&(options.onStep=function(offset,canvasSize,itemsSize,progress,stepPart){stepPart=Math.max(.05,stepPart),$progress.each((function(index){$(this).css("transform","translateX("+(100*(progress*(1-stepPart)-index)).toFixed(2)+"%) scaleX("+stepPart.toFixed(4)+")")}))}),$sliderItem.each((function(i){images[i]=[],$(this).find(".slider-specials-img").each((function(j){images[i][j]=this}))})),$slider.slider(options)}else $slider.addClass("slider-ready")})),$(".slider-poster").not(".slider-ready").each((function(){var $slider=$(this),$sliderItem=$slider.find(".slider-item");if(0!==$sliderItem.length){1===$sliderItem.length&&$slider.find(".slider-prev, .slider-next, .slider-nav").css("visibility","hidden");var images=[],currentItem=0,preload=function(index,id){var hisrc=function(index){for(var i=0;images[index]&&i<images[index].length;i++)void 0!==images[index][i]&&(gImgSrcset(images[index][i],"slider"),delete images[index][i])};kommersant.utils.checkInViewport($slider,null,null,(function(isVisible){isVisible&&(hisrc(index),hisrc(index+1))}))},options={isTransform3d:!1,isKeyboard:!0,isLooped:!0,isAutoSlide:!0,margin:30,autoSlideInterval:5e3,onReady:function(index,id){currentItem=index,preload(index),$window.on("resize scroll",(function(){kommersant.utils.checkInViewport($slider,(function(){preload(currentItem)}))}))},onComplete:function(index,id){index!=currentItem&&(preload(index),currentItem=index)}};$sliderItem.each((function(i){images[i]=[],$(this).find(".slider-poster-img").each((function(j){images[i][j]=this}))})),$slider.slider(options)}else $slider.addClass("slider-ready")})),$(".slider-doc-text").each((function(){$(this).slider({isTransform3d:!1,margin:30,align:0})})),$(".slider-story").not(".slider-ready").each((function(){var $slider=$(this);if(0!==$slider.find(".slider-item").length){var $progress=$slider.find(".slider-story-progress");$slider.slider({isTransform3d:!1,align:0,margin:51,onStep:function(offset,canvasSize,itemsSize,progress,stepPart){stepPart=Math.max(.05,stepPart),progress>1&&(progress=1),progress<=0&&(progress=0),$progress.css("transform","translateX("+(progress*(1-stepPart)*100).toFixed(2)+"%) scaleX("+stepPart.toFixed(4)+")")}})}else $slider.addClass("slider-ready")})),$(".slider-review").not(".slider-ready").each((function(){var options={margin:10},$slider=$(this),$sliderItem=$slider.find(".slider-item");0!==$sliderItem.length?(1===$sliderItem.length&&($slider.find(".slider-prev, .slider-next, .review_slider-nav_lineup").css("visibility","hidden"),options.isDraggable=!1,options.isElastic=!1,options.isTransform=!1),$slider.slider(options)):$slider.addClass("slider-ready")})),$(".slider-involve").each((function(){$(this).slider({align:0,margin:7,isLooped:!0})})),$(".js-gallery-doc").not(".js-gallery-ready").each((function(){var $sliderItem,timerInfo,gallery=this,$gallery=$(gallery),$sliderPhotos=$gallery.find(".js-gallery-slider-photos"),$sliderThumbs=$gallery.find(".js-gallery-slider-thumbs"),$progress=$gallery.find(".js-gallery-progress"),$resizable=$gallery.find(".js-gallery-resizable"),isInfo=!0,images=[],currentItem=0,currentId=1,isDragged=!1,onChange=$gallery.data("gallery-onchange")||"",isHash=kommersant.utils.dataBoolean($gallery.data("gallery-hash")),isHistory=isHash&&kommersant.utils.dataBoolean($gallery.data("gallery-history")),isCounters=kommersant.utils.dataBoolean($gallery.data("gallery-counters")),isSocial=kommersant.utils.dataBoolean($gallery.data("gallery-social")),preload=function(index,id){var hisrc=function(index){for(var i=0;images[index]&&i<images[index].length;i++)void 0!==images[index][i]&&(gImgSrcset(images[index][i],"slider"),delete images[index][i])};kommersant.utils.checkInViewport($gallery,null,null,(function(isVisible){isVisible&&(hisrc(index),hisrc(index+1))}))},resize=function(index,id){$resizable.each((function(){var $resizable=$(this),$current=$resizable.find(".js-gallery-resizable-item-current");$resizable.css("height",$current.outerHeight(!0)||0)}))},update=function(index,id){if(preload(index),currentId=id,isHash&&function(index,id){var hash="#"+id;window.location.hash!=hash&&(isHistory?"pushState"in history?history.pushState(null,null,hash):window.location=hash:"replaceState"in history?history.replaceState(null,null,hash):window.location.replace(hash))}(0,id),isSocial&&function(index,id){var i,description=$sliderItem.eq(index).find(".js-gallery-description").text().replace(/\s{2,}/g," ").replace(/^\s+/g,"").replace(/\s+$/g,""),options={url:canonical[0]+"#"+id,description:description};for(i=0;images[index]&&i<images[index].length;i++)if(void 0!==images[index][i]&&"img"===images[index][i].tagName.toLowerCase()&&images[index][i].src){options.picture=images[index][i].src;break}kommersant.updateSocialButtons(options)}(index,id),isCounters&&index!==currentItem)try{countersUpdate()}catch(ignore){}$resizable.each((function(){$(this).find(".js-gallery-resizable-item").each((function(i){$(this).toggleClass("js-gallery-resizable-item-current",i===index),resize()}))})),setTimeout((function(){$window.trigger("scroll")}),100),currentItem=index};$sliderPhotos.each((function(){var $slider=$(this);0!==($sliderItem=$sliderPhotos.find(".slider-item")).length&&($gallery.toggleClass("gallery_single",1===$sliderItem.length),1===$sliderItem.length&&($sliderThumbs.remove(),$progress.remove(),$gallery.find(".slider-prev, .slider-next, .slider-nav").css("visibility","hidden")),$sliderItem.each((function(i){images[i]=[],$(this).find(".js-gallery-img").each((function(j){images[i][j]=this}))})),$slider.slider({isKeyboard:!0,isElastic:$sliderItem.length>1,start:isHash&&window.location.hash.slice(1)||1,margin:30,onReady:function(index,id){$gallery.toggleClass("js-gallery-ready",!0),$window.on("resize scroll",(function(){kommersant.utils.checkInViewport($gallery,(function(){preload(currentItem)}))})),$resizable.length>0&&($window.on("kommersant:resize",(function(event){resize()})),document.addEventListener("load",(function(event){resize()}),!0),resize(),$resizable.css({overflow:"hidden",height:0,transition:"height 400ms ease"})),timerInfo=setTimeout((function(){$gallery.toggleClass("js-gallery-info",isInfo)}),500),update(index,id)},onChange:function(index,id,reason){isDragged||($sliderThumbs.slider("goTo",id),""!==onChange&&void 0!==window[onChange]&&window[onChange].call(gallery,index,id,"method"===reason?"thumbnails-click":reason))},onComplete:function(index,id){index===currentItem||isDragged||(update(index,id),resize())},onPseudoClick:function(index,id){clearTimeout(timerInfo),isInfo=!isInfo,$gallery.toggleClass("js-gallery-info",isInfo)}}))})),0!==$sliderItem.length?($sliderThumbs.each((function(){$(this).slider({isMomentum:!0,start:isHash&&window.location.hash.slice(1)||1,margin:10,onReady:function(index,id){},onDragStart:function(index,id){isDragged=!0},onDragEnd:function(index,id){isDragged=!1},onChange:function(index,id,reason){isDragged&&(isDragged=!1,$sliderPhotos.slider("goTo",id,0),update(index,id),""!==onChange&&void 0!==window[onChange]&&window[onChange].call(gallery,index,id,"thumbnails-drag"))},onPseudoClick:function(index,id){$sliderPhotos.slider("goTo",id,0)},onPass:function(index,id){isDragged&&$sliderPhotos.slider("goTo",id,0)},onStep:function(offset,canvasSize,itemsSize,progress,stepPart){stepPart=Math.max(.05,stepPart),progress>1&&(progress=1),progress<=0&&(progress=0),$progress.css("transform","translateX("+(progress*(1-stepPart)*100).toFixed(2)+"%) scaleX("+stepPart.toFixed(4)+")")}})})),isHash&&$window.on("hashchange",(function(event){var id=window.location.hash.slice(1)||1;id!==currentId&&(event.preventDefault(),$sliderPhotos.slider("goTo",id))}))):$gallery.addClass("js-gallery-ready")})),$(".js-gallery-gallery").not(".js-gallery-ready").each((function(){var $sliderItem,timerInfo,$gallery=$(this),$sliderPhotos=$gallery.find(".js-gallery-slider-photos"),$sliderThumbs=$gallery.find(".js-gallery-slider-thumbs"),$progress=$gallery.find(".js-gallery-progress"),$resizable=$gallery.find(".js-gallery-resizable"),isInfo=!0,images=[],currentItem=0,currentId=1,count=0,isDragged=!1,resize=function(index,id){$resizable.each((function(){var $resizable=$(this),$current=$resizable.find(".js-gallery-resizable-item-current");$resizable.css("height",$current.outerHeight(!0)||0)}))},update=function(index,id){if(window.picsId=getNumericId(id),function(index,id){var hisrc=function(index){for(var i=0;images[index]&&i<images[index].length;i++)void 0!==images[index][i]&&(gImgSrcset(images[index][i],"slider"),delete images[index][i])};hisrc(index),hisrc(index+1),hisrc(index-1)}(index),function(index,id){var $lazyload=$sliderItem.eq(index).find(".slider-lazyload");$lazyload.length&&($lazyload.each((function(){var $template=$(this),html=$template.html();html=kommersant.utils.uncomment(html.replace(/\{\{(.*?)\}\}/g,"$1")),$template.replaceWith(html)})),kommersantInit())}(index),currentId=id,function(index,id){var hash="#"+id;window.location.hash!=hash&&("replaceState"in history?history.replaceState(null,null,hash):window.location.replace(hash))}(0,id),function(index,id){var i,description=$sliderItem.eq(index).find(".js-gallery-description").text().replace(/\s{2,}/g," ").replace(/^\s+/g,"").replace(/\s+$/g,""),options={url:canonical[0]+"#"+id,description:description};for(i=0;images[index]&&i<images[index].length;i++)if(void 0!==images[index][i]&&"img"===images[index][i].tagName.toLowerCase()&&images[index][i].src){options.picture=images[index][i].src;break}kommersant.updateSocialButtons(options)}(index,id),index!==currentItem)try{countersUpdate()}catch(ignore){}$resizable.each((function(){$(this).find(".js-gallery-resizable-item").each((function(i){$(this).toggleClass("js-gallery-resizable-item-current",i===index),resize()}))})),setTimeout((function(){$window.trigger("scroll")}),100),currentItem=index},getItems=function(){$sliderItem=$sliderPhotos.find(".slider-item")},getNumericId=function(id){return"string"==typeof id&&id.length>2?id.slice(2):""};$sliderPhotos.each((function(){var $slider=$(this);if(getItems(),0!==$sliderItem.length){var sids=function(){var paramParts,i,queryParts=window.location.search.slice(1).split("&"),value="",sids=[];for(i=0;i<queryParts.length;i++)if("sids"===(paramParts=queryParts[i].split("="))[0]){value=decodeURIComponent(paramParts[1]);break}return value&&(sids=value.split(",")),sids}();if(sids.length>0){var $thumbs=$sliderThumbs.find(".slider-item");if($sliderItem.each((function(index){var $item=$(this),id=""+$item.data("slider-id");sids.indexOf(getNumericId(id))<0&&($item.remove(),$thumbs.eq(index).remove())})),getItems(),0===$sliderItem.length)return}$gallery.toggleClass("gallery_single",1===$sliderItem.length),1===$sliderItem.length&&($sliderThumbs.remove(),$progress.remove(),$gallery.find(".slider-prev, .slider-next, .slider-nav").css("visibility","hidden")),$sliderItem.each((function(i){images[i]=[],$(this).find(".js-gallery-img").each((function(j){images[i][j]=this}))})),$slider.slider({isKeyboard:!0,isElastic:$sliderItem.length>1,start:window.location.hash.slice(1)||1,margin:30,onReady:function(index,id){$gallery.toggleClass("js-gallery-ready",!0),$resizable.length>0&&($window.on("kommersant:resize",(function(event){resize()})),document.addEventListener("load",(function(event){resize()}),!0),resize(),$resizable.css({overflow:"hidden",height:0,transition:"height 400ms ease"})),timerInfo=setTimeout((function(){$gallery.toggleClass("js-gallery-info",isInfo)}),500),update(index,id)},onChange:function(index,id,reason){isDragged||$sliderThumbs.slider("goTo",id)},onComplete:function(index,id){index===currentItem||isDragged||(count++,update(index,id),resize(),count%4==0&&kommersant.advReload(".adv3-6_240pxx400px, .adv"))},onPseudoClick:function(index,id){clearTimeout(timerInfo),isInfo=!isInfo,$gallery.toggleClass("js-gallery-info",isInfo)}})}})),0!==$sliderItem.length?($sliderThumbs.each((function(){$(this).slider({isMomentum:!0,start:window.location.hash.slice(1)||1,margin:10,onReady:function(index,id){},onDragStart:function(index,id){isDragged=!0},onDragEnd:function(index,id){isDragged=!1},onChange:function(index,id,reason){isDragged&&(isDragged=!1,$sliderPhotos.slider("goTo",id,0),update(index,id))},onPseudoClick:function(index,id){$sliderPhotos.slider("goTo",id,0)},onPass:function(index,id){isDragged&&$sliderPhotos.slider("goTo",id,0)},onStep:function(offset,canvasSize,itemsSize,progress,stepPart){stepPart=Math.max(.05,stepPart),progress>1&&(progress=1),progress<=0&&(progress=0),$progress.css("transform","translateX("+(progress*(1-stepPart)*100).toFixed(2)+"%) scaleX("+stepPart.toFixed(4)+")")}})})),$window.on("hashchange",(function(event){var id=window.location.hash.slice(1)||1;id!==currentId&&(event.preventDefault(),$sliderPhotos.slider("goTo",id))}))):$gallery.addClass("js-gallery-ready")})),$(".js-gallery-template").each((function(){var $template=$(this),html=$template.html();html=kommersant.utils.uncomment(html),$template.prop("className",""),$template.empty(),kommersant.utils.loadStyle(kommersant.antiCache.cssGallery).then((function(){$template.replaceWith(html),kommersantInit()}),(function(){}))}))),$(".js-chart").length>0&&kommersant.utils.loadScript(kommersant.antiCache.jsCharts).catch((function(){})),$(".js-widget").length>0&&kommersant.utils.loadScript(kommersant.antiCache.jsWidgets).catch((function(){})),"function"!=typeof $.fn.zoom||kommersant.isTouch||$(".zoom").each((function(){var $this=$(this);if(!$this.hasClass("zoom-ready")){var options={},dataSrc=$this.data("zoom-src"),dppx=window.devicePixelRatio||1,isReady=!1,isHover=!1,fnMouseEnter=function(event){isHover=!0},fnMouseLeave=function(event){isHover=!1};"string"==typeof dataSrc&&dataSrc.length>0&&(options.url=dataSrc),options.duration=0,dppx>1&&(options.magnify=1/dppx),$this.on("mouseenter",fnMouseEnter),$this.on("mouseleave",fnMouseLeave),$this.one("mouseover mousemove",(function(event){isReady||(isReady=!0,isHover=!0,$this.css({cursor:"progress"}),options.callback=function(){$this.off("mouseenter",fnMouseEnter),$this.off("mouseleave",fnMouseLeave),$this.css({cursor:""}),isHover&&$this.trigger("mouseover")},$this.zoom(options))})),$this.addClass("zoom-ready")}})),!isTooltipInitialized&&$(".tooltip").length&&(isTooltipInitialized=!0,kommersant.templates.load().then((function(){var timer,isShown=!1,isVisible=!1,currentHtml="",html=$(kommersant.templates.apply("tooltip")),$tooltipWindow=$(html),hide=function(isForce){isShown&&(clearTimeout(timer),$tooltipWindow.remove(),isShown=!1,isForce?isVisible=!1:timer=setTimeout((function(){isVisible=!1}),500))};$document.on("mouseover",".tooltip",(function(event){event.stopPropagation();var $template=$(this),html="",dataContent=$template.data("tooltip-content"),dataTemplate=$template.data("tooltip-template");dataContent?html=dataContent.replace(/\\n/g,"<br>"):dataTemplate&&(html=$(dataTemplate).html()),""!==html&&function(html){if(!isShown||currentHtml!==html){var showFn=function(){$tooltipWindow.css({visibility:""}),isVisible=!0};clearTimeout(timer),$tooltipWindow.html(html),$tooltipWindow.css({visibility:"hidden"}),$tooltipWindow.appendTo(document.body),isVisible?showFn():timer=setTimeout(showFn,250),isShown=!0,currentHtml=html}}(html)})),$document.on("mousemove",".tooltip",(function(event){if(event.stopPropagation(),isShown){var width=$tooltipWindow.outerWidth(!0),height=$tooltipWindow.outerHeight(!0),left=event.pageX,top=event.pageY;left+width>$window.width()+$window.scrollLeft()&&(left=event.pageX-width)<0&&(left=0),top+height>$window.height()+$window.scrollTop()&&(top=event.pageY-height)<0&&(top=0),$tooltipWindow.css({left:left,top:top})}})),$document.on("mouseout",".tooltip",(function(event){event.stopPropagation(),hide()})),$document.on("keydown",(function(event){27!==event.keyCode||event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||hide(!0)}))}),(function(){}))),"function"==typeof $.fn.fitVids&&($(".fitvids, .b-article, .b-abandoned, .b-forums, .article_text_wrapper").fitVids({customSelector:'.lazyload > iframe[width][width!=""][width!="100%"][height][height!=""], iframe.fitvids, iframe[src*="platformcraft"], iframe[src*="//maps."], iframe[src*="google.com/maps/"], iframe[src*="//instagram.com"]'}),$(".col-small > .gbox").fitVids()),$window.trigger("resize",!0),kommersant.isWebView&&(window.open=function(url){return url&&(window.location.href=url),window},$("a[target]").prop("target",""))},"/"===window.location.pathname&&$(".b-newsline__item").each((function(i){i>=7&&$(this).addClass("hide1 hide2")})),$(".b-newsline__menu_item__more").on("click",(function(event){event.preventDefault(),$(this).remove(),$(".b-newsline__item").removeClass("hide1 hide2 hide3")})),function(){var setProtocol=function(url,protocol){return"string"!=typeof url&&(url=""),url.replace(/(.*\/\/)/,protocol+"://")},removeSubdomain=function(s,subject){return"string"!=typeof s?"":subject instanceof Array&&subject.length>0?removeSubdomain(removeSubdomain(s,subject[0]),subject.slice(1)):s.replace(subject instanceof RegExp?subject:"//"+subject+".","//")},withWww=function(s){return function(s,subject){return"string"!=typeof s?"":s.split("//").join("//"+subject+".")}(withoutWww(s),"www")},withoutWww=function(s){return removeSubdomain(s,["www","www0","beta","dev",/\/\/stage\d*.\./])},canonicalPush=function(subject){var https=setProtocol(subject,"https"),http=setProtocol(subject,"http");subject&&(kommersant.utils.addUniqueElement(withWww(https),canonical),kommersant.utils.addUniqueElement(withWww(http),canonical),kommersant.utils.addUniqueElement(withoutWww(https),canonical),kommersant.utils.addUniqueElement(withoutWww(http),canonical))};$head.find('link[rel="canonical"]').each((function(){canonicalPush(this.href)})),$head.find('meta[property="og:url"]').each((function(){canonicalPush(this.content)}));var url=kommersant.mainHost+window.location.pathname+function(s){var i;"string"!=typeof s&&(s="");var parts=s.slice(1).split("&");for(i=0;i<parts.length;i++)0!==parts[i].indexOf("utm")&&0!==parts[i].indexOf("from=")||parts.splice(i--,1);return""!==(s=parts.join("&"))&&(s="?"+s),s}(window.location.search);canonicalPush(url)}(),isOn=!1,$window.on("resize",(function(event,isRefresh){if(isRefresh)return clearTimeout(timerEnd),clearTimeout(timerInterval),isOn=!1,kommersant.utils.triggerCustomEvent(window,"kommersant:resizeend"),void kommersant.utils.triggerCustomEvent(window,"kommersant:resize");clearTimeout(timerEnd),timerEnd=setTimeout((function(){kommersant.utils.triggerCustomEvent(window,"kommersant:resizeend")}),250),isOn||(clearTimeout(timerInterval),timerInterval=setTimeout((function(){kommersant.utils.triggerCustomEvent(window,"kommersant:resize"),isOn=!1}),250),isOn=!0)})),function(){var timerInterval,timerEnd,isOn=!1;$window.on("scroll",(function(event){clearTimeout(timerEnd),timerEnd=setTimeout((function(){kommersant.utils.triggerCustomEvent(window,"kommersant:scrollend")}),250),isOn||(clearTimeout(timerInterval),timerInterval=setTimeout((function(){kommersant.utils.triggerCustomEvent(window,"kommersant:scroll"),isOn=!1}),250),isOn=!0)}))}(),resizeFunction=function(event){var media=window.getComputedStyle?window.getComputedStyle(document.body,":after").getPropertyValue("content"):"",lastMedia=kommersant.media;'"'!==media[0]&&"'"!==media[0]||(media=media.slice(1,-1)),media!==lastMedia&&(kommersant.media=media,kommersant.utils.triggerCustomEvent(document,"kommersant:mediachange",{lastMedia:lastMedia,newMedia:media}))},$window.on("kommersant:resize",resizeFunction),resizeFunction(),lastActivity=new Date,lastReported=new Date,handler=function(event){var now=new Date;kommersant.lastActivity=now,now-lastReported>=1e3&&(kommersant.utils.triggerCustomEvent(document,"kommersant:useractivity",{inactivityTime:now-lastActivity}),lastReported=now),lastActivity=now},$window.on("focus",handler),$document.on("mousedown mousemove mouseup keydown keyup touchstart touchend visibilitychange",handler),function(){var $resize=$(".resize");if(0!==$resize.length){var resizeFunction=function(event){$resize.filter(":really-hidden").each((function(){var $this=$(this),$places=$($this.data("resize-places")||"").not(":really-hidden").first();0!==$places.length&&($this.appendTo($places),$window.trigger("resize"))}))};$window.on("kommersant:resize",resizeFunction),resizeFunction()}}(),loadSource=function(trigger){var $trigger=$(trigger),$lazyimage=$trigger.closest(".js-lazyimage");$trigger.removeClass("js-lazyimage-trigger"),$lazyimage.find(".js-lazyimage-source").addBack(".js-lazyimage-source").each((function(){gImgSrcset(this,"lazyimage",(function(){$window.trigger("resize")}))})),$lazyimage.addClass("js-lazyimage-loaded")},checkForceIfVisible=function(){kommersant.utils.checkInViewport(".js-lazyimage-trigger",null,null,(function(isVisible){isVisible&&loadSource(this)}))},$window.on("resize scroll",(function(){kommersant.utils.checkInViewport(".js-lazyimage-trigger",(function(){loadSource(this)}))})),setInterval(checkForceIfVisible,1e3),checkForceIfVisible(),dataFired="lazyload-fired",reInit=function(element){kommersantInit(),kommersant.utils.triggerCustomEvent(element||document,"kommersant:lazyload")},error=function(element){kommersant.utils.triggerCustomEvent(element||document,"kommersant:lazyloaderror")},update=function(){var $lazyloadAll=$(".lazyload");if(0!==$lazyloadAll.length){var windowScrollTop=$window.scrollTop(),windowScrollLeft=$window.scrollLeft(),windowWidth=$window.width(),windowHeight=$window.outerHeight();$lazyloadAll.each((function(){var $newLazyload,ajaxHandler,$lazyload=$(this),url=$lazyload.data("lazyload-url")||"",content=$lazyload.data("lazyload-content")||"",screensBefore=$lazyload.data("lazyload-screens-before")||0,screensAfter=$lazyload.data("lazyload-screens-after")||0,isUrl=""!==url,isUnloadable=kommersant.utils.dataBoolean($lazyload.data("lazyload-unloadable")),isFired=kommersant.utils.dataBoolean($lazyload.data(dataFired)),isRead=kommersant.utils.dataBoolean($lazyload.data("lazyload-read")),isLoaded=kommersant.utils.dataBoolean($lazyload.data("lazyload-loaded")),append=function(content){var i,scriptsSrc=[],scriptsInline=[],promises=[],tmp=document.createElement("div");tmp.insertAdjacentHTML("beforeend",content);var scripts=tmp.querySelectorAll("script");for(i=0;i<scripts.length;i++)scripts[i].src.length>0&&(scriptsSrc.push(scripts[i].src),scripts[i].removeAttribute("src"));if(scriptsSrc.length>0){for(i=0;i<scripts.length;i++)0===scripts[i].src.length&&scripts[i].text.length>0&&(scriptsInline.push(scripts[i].text),scripts[i].innerHTML="");content=kommersant.utils.trim(tmp.innerHTML),$lazyload.html(content),$lazyload.find('div[id^="vk_post_"]').empty();var appendPromise=new Promise((function(resolve,reject){for(i=0;i<scriptsSrc.length;i++)promises.push(kommersant.utils.loadScript(scriptsSrc[i]));Promise.all(promises).then((function(){resolve()}),(function(){reject()}))})),result=Promise.all(promises.concat([appendPromise]));return result.then((function(){for(i=0;i<scriptsInline.length;i++)$lazyload.each((function(){var s=document.createElement("script");s.text=scriptsInline[i],this.insertAdjacentElement("beforeend",s)}))}),(function(){})),result}return $lazyload.html(content),Promise.resolve()};if(!isRead){content=kommersant.utils.uncomment($lazyload.html()).replace(/\{\{(.*?)\}\}/g,"$1").replace(/ data-twitter-extracted-i[0-9]+=".*?"/g,""),$lazyload.data("lazyload-content",content),$lazyload.data("lazyload-read",!0);var data=$lazyload.data();$newLazyload=$('<div class="lazyload"></div>'),$lazyload.replaceWith($newLazyload),($lazyload=$newLazyload).data(data),isRead=!0}if(!isFired||isUnloadable)var offset=$lazyload.offset(),isVisibleV=windowScrollTop>=offset.top-windowHeight*(screensBefore+1)&&windowScrollTop<=offset.top+$lazyload.outerHeight()+windowHeight*screensAfter,isVisibleH=windowScrollLeft>=offset.left-windowWidth&&windowScrollLeft<=offset.left+$lazyload.outerWidth(),isVisible=isVisibleV&&isVisibleH&&!$lazyload.is(":really-hidden");if(isVisible&&!isFired&&(isFired=!0,$lazyload.data(dataFired,isFired),isUrl&&!isLoaded?(""!==content&&append(content),ajaxHandler=$.ajax({url:url,method:"GET",dataType:"html",timeout:15e3,success:function(newContent){if(isLoaded=!0,content=newContent,$lazyload.data("lazyload-loaded",isLoaded),$lazyload.data("lazyload-content",content),!newContent.length)return $lazyload.empty(),void error($lazyload.get(0));append(content).then((function(){reInit($lazyload.get(0))}),(function(){}))},error:function(jqXHR,textStatus,errorThrown){if($lazyload.empty(),"error"===textStatus)return isLoaded=!0,content="",$lazyload.data("lazyload-loaded",isLoaded),$lazyload.data("lazyload-content",content),void error($lazyload.get(0));"timeout"===textStatus&&(isFired=!1,$lazyload.data(dataFired,isFired),$window.trigger("scroll"))}})):append(content).then((function(){reInit($lazyload.get(0))}),(function(){}))),isFired&&!isVisible&&isUnloadable){if(isFired=!1,isUrl)try{ajaxHandler.abort()}catch(ignore){}$lazyload.empty(),$lazyload.data(dataFired,isFired),reInit($lazyload.get(0))}}))}},$document.on("click",".lazyload-button",(function(event){event.preventDefault();var $button=$(this),$wrapper=$button.closest(".lazyload-button-wrapper"),url=$button.data("lazyload-url")||"";1!==$wrapper.length&&($wrapper=$button),$button.prop("disabled",!0),kommersant.templates.load().then((function(){var content;content=""===url?kommersant.utils.uncomment($wrapper.find(".lazyload-button-content").html()).replace(/\{\{(.*?)\}\}/g,"$1"):kommersant.templates.apply("loading"),$wrapper.after(kommersant.templates.apply("lazyload",{url:url,content:content})),$wrapper.remove(),$window.trigger("scroll")}))})),$window.on("resize scroll",(function(event){update()})),update(),$document.on("click",".changeclass",(function(event){var selector,action,$this=$(this),result=!1,data=$this.data("changeclass");if(void 0===$this.data("changeclass-nopreventdefault")&&event.preventDefault(),"object"==typeof data){for(selector in data)if("object"==typeof data[selector])for(action in data[selector])switch(action){case"addClass":$(selector).addClass(data[selector][action]),result=!0;break;case"removeClass":$(selector).removeClass(data[selector][action]),result=!0;break;case"toggleClass":$(selector).toggleClass(data[selector][action]),result=!0}result&&$window.trigger("resize",!0)}})),handlerKeydown=function(event){27!==event.keyCode||event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||(event.stopImmediatePropagation(),close())},refresh=function(){$window.trigger("resize",!0)},close=function(){var i,result=!1,callbacks=[];if($(".modal").each((function(){result=!0;var $this=$(this),dataOnClose=$this.data("modal-onclose")||"";"function"==typeof window[dataOnClose]&&callbacks.push({functionName:dataOnClose,that:this}),void 0!==$this.data("generated")?$this.remove():$this.removeClass("modal")})),result)for($body.css({overflow:""}),document.removeEventListener("keydown",handlerKeydown,!0),refresh(),i=0;i<callbacks.length;i++)window[callbacks[i].functionName].call(callbacks[i].that)},$document.on("click",".modal_trigger",(function(event){event.preventDefault();var i,result=!1,$this=$(this),dataSelector=$this.data("modal-selector")||"",dataTemplate=$this.data("modal-template")||"",callbacks=[];if(""!==dataSelector){var $modal=$(dataSelector);$modal.length>0&&(result=!0,$modal.each((function(){var dataOnOpen=$(this).data("modal-onopen")||"";"function"==typeof window[dataOnOpen]&&callbacks.push({functionName:dataOnOpen,that:this})})),$modal.addClass("modal"))}if(""!==dataTemplate){var html=$(dataTemplate).first().html();if(html){result=!0;var $html=$(html);$html.data("generated",1),$html.addClass("modal"),$html.appendTo(document.body),kommersantInit()}}if(result)for($body.css({overflow:"hidden"}),document.addEventListener("keydown",handlerKeydown,!0),refresh(),i=0;i<callbacks.length;i++)window[callbacks[i].functionName].call(callbacks[i].that)})),$document.on("click",".modal_close",(function(event){event.preventDefault(),close()})),getDuration=function($more){var duration=parseInt($more.data("more-duration"),10);return isNaN(duration)&&(duration=400),duration},$(".more").each((function(){var $more=$(this),isHidden=!$more.hasClass("more-expanded"),$moreHidden=$more.find(".more-hidden"),$moreTriggers=$more.find(".more-trigger");$moreHidden.each((function(){var $hidden=$(this),$parent=$hidden.parent(),$prev=$hidden.prev(),$next=$hidden.next();$hidden.add($parent).add($prev).add($next).not(".more-overflow").css("overflow","hidden")})),isHidden||$moreHidden.show(),$moreTriggers.each((function(){var $trigger=$(this);$trigger.hasClass("more-trigger-toggle")||(isHidden===$trigger.hasClass("more-trigger-hide")?$trigger.addClass("hide"):$trigger.removeClass("hide"))}))})),$document.on("click",".more-trigger",(function(event){event.preventDefault();var $more=$(this).closest(".more"),$moreHidden=$more.find(".more-hidden"),$moreTriggers=$more.find(".more-trigger"),isHidden=!$more.hasClass("more-expanded"),duration=getDuration($more);$moreHidden.stop(!0,!0),$moreTriggers.each((function(){var $trigger=$(this);$trigger.hasClass("more-trigger-toggle")||(isHidden===$trigger.hasClass("more-trigger-hide")?$trigger.removeClass("hide"):$trigger.addClass("hide"))})),isHidden?($more.addClass("more-expanded"),$moreHidden.slideDown(duration,(function(){kommersantInit()})),$window.trigger("resize",!0)):($more.removeClass("more-expanded"),$moreHidden.slideUp(duration,(function(){$window.trigger("resize",!0)})))})),$document.on("click",".more-all-expand",(function(event){event.preventDefault(),$(this).addClass("hide"),$(".more-all-collapse").removeClass("hide"),$(".more").not(".more-expanded").each((function(){var $more=$(this),$moreHidden=$more.find(".more-hidden"),$moreTriggers=$more.find(".more-trigger"),duration=getDuration($more);$moreHidden.stop(!0,!0),$moreTriggers.each((function(){var $trigger=$(this);$trigger.hasClass("more-trigger-toggle")||($trigger.hasClass("more-trigger-hide")?$trigger.removeClass("hide"):$trigger.addClass("hide")),$more.addClass("more-expanded"),$moreHidden.slideDown(duration,(function(){kommersantInit()}))}))}))})),$document.on("click",".more-all-collapse",(function(event){event.preventDefault(),$(this).addClass("hide"),$(".more-all-expand").removeClass("hide"),$(".more.more-expanded").each((function(){var $more=$(this),$moreHidden=$more.find(".more-hidden"),$moreTriggers=$more.find(".more-trigger"),duration=getDuration($more);$moreHidden.stop(!0,!0),$moreTriggers.each((function(){var $trigger=$(this);$trigger.hasClass("more-trigger-toggle")||($trigger.hasClass("more-trigger-hide")?$trigger.addClass("hide"):$trigger.removeClass("hide")),$more.removeClass("more-expanded"),$moreHidden.slideUp(duration,(function(){$window.trigger("resize",!0)}))}))}))})),$(".js-all").each((function(){var $all=$(this),$checkboxes=$all.find(".js-all-checkbox"),$nested=$all.find(".js-all"),$triggers=$all.find(".js-all-trigger").not($nested.find(".js-all-trigger")),onChange=function(){var checked=!0;$checkboxes.each((function(){if(!this.checked)return checked=!1,!1})),$triggers.each((function(){var action=$(this).data("all-trigger-action")||"";"check"!==action&&"uncheck"!==action&&(this.checked=checked)}))};0!==$checkboxes.length&&0!==$triggers.length&&($triggers.on("click",(function(event){var checked;switch(this.type||event.preventDefault(),$(this).data("all-trigger-action")||""){case"check":checked=!0;break;case"uncheck":checked=!1;break;default:checked=!!this.checked}$checkboxes.each((function(){this.checked=checked,$(this).triggerHandler("change")}))})),$checkboxes.on("change",(function(event){onChange()})),onChange())})),0!==($additional=$(".js-additional")).length&&($additional.on("change",".js-additional-button",(function(event){var isReverse,i,$additional=$(this).closest(".js-additional"),target=this,$holder=$additional.find(".js-additional-holder").not($additional.find(".js-additional").find(".js-additional-holder"));if(void 0!==target.options)for(i=0;i<target.options.length;i++)$holder.eq(i).toggleClass("hide",i!==target.options.selectedIndex);else if("radio"===target.type&&"undefined"!==target.name){var fieldset=target.form[target.name];for(i=0;i<fieldset.length;i++)$holder.eq(i).toggleClass("hide",!fieldset[i].checked)}else $holder.each((function(){var $this=$(this);isReverse=kommersant.utils.dataBoolean($this.data("additional-reverse")),$this.toggleClass("hide",isReverse?target.checked:!target.checked)}));$holder.not(".hide").first().each((function(){var holder=this;$(holder).find(".js-additional-autofocus").first().each((function(){$(this).focus().select(),kommersant.utils.checkInViewport(holder,null,null,(function(isVisible){isVisible||$window.stop().scrollTo(holder,{margin:!0,offset:-100})}))}))}))})),$(".js-additional-button").trigger("change")),$document.on("click",".scrollto",(function(event){event.preventDefault();var subject,$this=$(this),href=$this.attr("href"),offset=$(".fixed_panel").height()||0;subject="string"==typeof href&&0===href.indexOf("#")&&href.length>1?href:$this.data("scrollto-subject")||0,$window.stop().scrollTo(subject,{margin:!0,offset:-offset})})),selectOnChange=function(){var $this=$(this),$fakeelementFake=$this.closest(".fakeelement").find(".fakeelement-select-fake"),option=this.options[this.options.selectedIndex],text=option&&option.text||"";$fakeelementFake.html(text),$this.prop("title",text)},$body.on("change",".fakeelement-select",selectOnChange),$(".fakeelement-select").each(selectOnChange),"function"==typeof $.fn.datepicker&&($.datepicker.regional.ru={closeText:"Закрыть",prevText:"Предыдущий",nextText:"Следующий",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вс","пн","вт","ср","чт","пт","сб"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Нед.",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},$.datepicker.setDefaults($.datepicker.regional.ru),$.datepicker.setDefaults({showAnim:!1}),$(".js-datepicker-single").each((function(){var $datepicker=$(this).find(".datepicker").addBack(".datepicker");1===$datepicker.length&&$datepicker.datepicker({changeMonth:!0,changeYear:!0,yearRange:"1990:c",minDate:new Date(1990,0,1),maxDate:0})})),$(".js-datepicker-range").each((function(){var $holder=$(this),$datepickerStart=$holder.find(".datepicker-start"),$datepickerEnd=$holder.find(".datepicker-end");1===$datepickerStart.length&&1===$datepickerEnd.length&&($datepickerStart.datepicker({changeMonth:!0,changeYear:!0,yearRange:"1990:c",minDate:new Date(1990,0,1),maxDate:0,onClose:function(selectedDate){$datepickerEnd.datepicker("option","minDate",selectedDate)}}),$datepickerEnd.datepicker({changeMonth:!0,changeYear:!0,yearRange:"1990:c",minDate:$datepickerStart.datepicker("getDate"),maxDate:0}))}))),cookieOptions={domain:"."+kommersant.domain,path:"/",expires:kommersant.utils.dateAdd(new Date,31536e6)},$fullversion=$(".fullversion"),kommersant.utils.getCookie("IsNonMobileViewport")&&$fullversion.removeClass("hide"),$(".fullversion-link-on").on("click",(function(event){event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||(event.preventDefault(),kommersant.utils.setCookie("IsNonMobileViewport",1,cookieOptions),window.location.reload())})),$(".fullversion-link-off").on("click",(function(event){event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||(event.preventDefault(),kommersant.utils.deleteCookie("IsNonMobileViewport",cookieOptions),window.location.reload())})),$(".navmenu").each((function(){var navmenuTimer,$navmenu=$(this),$navmenuToggle=$navmenu.find(".navmenu-toggle"),navmenuCurrent="",isDarkbox=!1,navmenuOnKeyDown=function(event){27!==event.keyCode||event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||(event.stopImmediatePropagation(),navmenuShow())},navmenuOnMousedown=function(event){isDarkbox&&0===event.type.indexOf("touch")&&event.preventDefault(),navmenuShow()},navmenuShow=function(id,type,url){var $navmenuItem;"string"!=typeof id&&(id=""),id!==navmenuCurrent&&("string"!=typeof type&&(type=""),"string"!=typeof url&&(url=""),""!==id&&0===($navmenuItem=$("#navmenu-"+id)).length&&(""===url?id="":($("#navmenu-rubrics").append(kommersant.templates.apply("navmenu-item",{type:type,id:id,loading:kommersant.templates.apply("loading")})),$navmenuItem=$("#navmenu-"+id),$.post(url,(function(data){var isActive=$navmenuItem.is(".navmenu-item-active");$navmenuItem.replaceWith(data),$navmenuItem=$("#navmenu-"+id),isActive&&($navmenuItem.addClass("navmenu-item-active"),gHisrcLoadVisible($navmenuItem))})))),""!==navmenuCurrent?($("#navmenu-"+navmenuCurrent).removeClass("navmenu-item-active"),$navmenu.find(".navmenu-toggle-active").removeClass("navmenu-toggle-active")):""!==id&&($root.on("touchstart mousedown",navmenuOnMousedown),$document.on("keydown",navmenuOnKeyDown)),""!==id?($navmenu.addClass("navmenu-active"),$navmenu.find(".navmenu-toggle-current").addClass("navmenu-toggle-active"),isDarkbox&&($("#navsearch-query").blur(),"function"==typeof $.fn.datepicker&&$(".datepicker, .datepicker-start, .datepicker-end").each((function(){var $datepicker=$(this);$datepicker.datepicker("hide"),$datepicker.is(":focus")&&$datepicker.blur()})),$darkbox.length?$darkbox.addClass("darkbox-active"):kommersant.templates.load().then((function(){($darkbox=$(kommersant.templates.apply("darkbox"))).prependTo($body)}),(function(){}))),$navmenuItem.length>0&&($navmenuItem.addClass("navmenu-item-active"),gHisrcLoadVisible($navmenuItem))):($root.off("touchstart mousedown",navmenuOnMousedown),$document.off("keydown",navmenuOnKeyDown),$darkbox.removeClass("darkbox-active"),$navmenu.removeClass("navmenu-active"),$navmenu.find(".navmenu-toggle-active").removeClass("navmenu-toggle-active")),navmenuCurrent=id)};$navmenuToggle.on("touchstart mouseenter mouseleave mousedown click",(function(event){var $this=$(this),id=$this.data("navmenu-id")||"",type=$this.data("navmenu-type")||"",url=$this.data("navmenu-url")||"";if(clearTimeout(navmenuTimer),isDarkbox=void 0!==$this.data("navmenu-darkbox"),kommersant.isTouch&&0!==event.type.indexOf("touch"))return event.preventDefault(),void event.stopPropagation();switch(event.type){case"touchstart":if(event.stopPropagation(),""!==id&&id===navmenuCurrent){navmenuShow();break}case"mouseenter":if(""!==id&&id!==navmenuCurrent){var fnShow=function(){navmenuShow(id,type,url)};$navmenu.find(".navmenu-toggle-current").removeClass("navmenu-toggle-current"),$this.addClass("navmenu-toggle-current"),"touchstart"===event.type||$navmenu.find(".navmenu-toggle-active").length>0?fnShow():navmenuTimer=setTimeout(fnShow,500)}break;case"mouseleave":navmenuTimer=setTimeout((function(){navmenuShow()}),100);break;case"mousedown":clearTimeout(navmenuTimer),event.stopPropagation()}})),$navmenuToggle.on("touchend",(function(event){event.preventDefault(),event.stopPropagation()})),$navmenu.on("mouseenter",".navmenu-item",(function(event){if(kommersant.isTouch)return event.preventDefault(),void event.stopPropagation();clearTimeout(navmenuTimer)})),$navmenu.on("mouseleave",".navmenu-item",(function(event){if(kommersant.isTouch)return event.preventDefault(),void event.stopPropagation();clearTimeout(navmenuTimer),navmenuTimer=setTimeout((function(){navmenuShow()}),1)})),$navmenu.on("touchstart touchend",".navmenu-item",(function(event){event.stopPropagation()})),$navmenu.on("mousedown",".navmenu-item",(function(event){kommersant.isTouch&&event.preventDefault(),event.stopPropagation()}))})),onClick=function(event){if(event){if(event.ctrlKey||event.altKey||event.shiftKey||event.metaKey)return;event.preventDefault()}var $a=$(this),href="",url="",metaTitle="",metaDescription="",imageSrc="",dataNetwork=$a.data("socials-network"),dataUrl=$a.data("socials-url"),dataPicture=$a.data("socials-picture"),dataQuote=$a.data("socials-quote"),dataTitle=$a.data("socials-title"),dataDescription=$a.data("socials-description"),truncate=function(s,n){return"string"==typeof s&&s.length>n&&(s=s.slice(0,n)+"..."),s},truncateTitle=function(s){return truncate(s,150)},truncateDescription=function(s){return truncate(s,300)},getQuery=function(params){var parts=[];for(var i in params)params[i]&&parts.push(i+"="+encodeURIComponent(params[i]));return parts.join("&")},getFullTitle=function(){return[void 0!==dataTitle?dataTitle:metaTitle,void 0!==dataDescription?dataDescription:metaDescription].join(" // ")};if(event&&""===dataNetwork&&(dataUrl||"")+(dataPicture||"")+(dataQuote||"")+(dataTitle||"")+(dataDescription||"")!=="")$(".socials-link").each((function(){var $a=$(this),isChanged=!1;$a.data("socials-network")&&(void 0!==dataUrl&&($a.data("socials-url",dataUrl),isChanged=!0),void 0!==dataPicture&&($a.data("socials-picture",dataPicture),isChanged=!0),void 0!==dataQuote&&($a.data("socials-quote",dataQuote),isChanged=!0),void 0!==dataTitle&&($a.data("socials-title",dataTitle),isChanged=!0),void 0!==dataDescription&&($a.data("socials-description",dataDescription),isChanged=!0)),isChanged&&onClick.call(this)}));else if(dataNetwork){switch(url=dataUrl||canonical[0],metaTitle=$head.find('meta[property="og:title"]').prop("content")||"",metaDescription=$head.find('meta[property="og:description"]').prop("content")||"",imageSrc=$head.find('link[rel="image_src"]').prop("href")||"",dataNetwork){case"fb":href="https://www.facebook.com/sharer.php?"+getQuery({u:url,title:truncateTitle(void 0!==dataTitle?dataTitle:metaTitle),description:truncateDescription(void 0!==dataQuote||void 0!==dataDescription?dataQuote||dataDescription:metaDescription)});break;case"vk":href="https://vk.com/share.php?"+getQuery({url:url,image:void 0!==dataPicture?dataPicture:imageSrc,title:truncateDescription(dataQuote||getFullTitle()),noparse:"true"});break;case"tw":href="https://twitter.com/intent/tweet?"+getQuery({url:url,text:truncateDescription(dataQuote||getFullTitle())});break;case"ok":href="https://connect.ok.ru/offer?"+getQuery({url:url,imageUrl:void 0!==dataPicture?dataPicture:imageSrc,title:truncateTitle(void 0!==dataTitle?dataTitle:metaTitle),description:truncateDescription(void 0!==dataQuote||void 0!==dataDescription?dataQuote||dataDescription:metaDescription)});break;case"gp":href="https://plus.google.com/share?"+getQuery({url:url});break;case"tg":href="https://t.me/share/url?"+getQuery({url:url,text:truncateDescription(dataQuote||getFullTitle())});break;case"wa":href="https://wa.me/?"+getQuery({text:url+"\n"+truncateDescription(dataQuote||getFullTitle())});break;case"ml":href="mailto:?"+getQuery({subject:truncateTitle(void 0!==dataTitle?dataTitle:metaTitle),body:truncateDescription(void 0!==dataQuote||void 0!==dataDescription?dataQuote||dataDescription:metaDescription)+"\n\n"+url})}if(href&&(this.href=href),!event||event.ctrlKey||event.altKey||event.shiftKey||event.metaKey)return;(href||this.href&&"#"!==$a.attr("href"))&&kommersant.utils.windowOpen(href||this.href,"socials",800,450)}event&&!dataNetwork&&this.href&&"#"!==$a.attr("href")&&kommersant.utils.windowOpen(this.href,"socials",800,450)},$document.on("click",".socials-link",onClick),$document.on("kommersant:click",".socials-link",(function(){onClick.call(this)})),$(".socials-link").each((function(){onClick.call(this)})),$document.on("click",".togglable__trigger",(function(event){event.preventDefault();var $this=$(this),$root=$this.closest(".togglable"),$input=$root.find(".togglable__input"),dataState=$this.data("togglable-state"),state=void 0!==dataState?!!dataState:$root.hasClass("togglable--1");$root.removeClass("togglable--"+(state?0:1)),$root.addClass("togglable--"+(state?1:0)),$input.prop("disabled",!state)})),$(".togglable").each((function(){var $this=$(this);$this.hasClass("togglable--0")&&$this.find(".togglable__input").prop("disabled",!0)})),function(){var $navsearch=$("#navsearch"),$navsearchForm=$("#navsearch-form"),$navsearchQuery=$("#navsearch-query"),$navsearchSubmit=$("#navsearch-submit"),show=function(){$navsearch.hasClass("is_active")||($navsearch.addClass("is_active"),$navsearchQuery.select(),kommersant.sendEvent("new_header","click","search"))},hide=function(){$navsearch.hasClass("is_active")&&($navsearch.removeClass("is_active"),$navsearchQuery.blur())};if(1!==$navsearch.length||1!==$navsearchForm.length||1!==$navsearchQuery.length)return!1;$navsearchForm.on("submit",(function(event){return $navsearch.hasClass("is_active")?""===$navsearchQuery.val()?(hide(),!1):void 0:(show(),$navsearchQuery.focus(),!1)})),$navsearchQuery.on("focus",(function(event){show()})),$navsearchQuery.on("blur",(function(event){hide()})),$navsearchQuery.on("keydown",(function(event){27!==event.keyCode||event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||(event.stopImmediatePropagation(),hide())})),$navsearchQuery.on("input change",(function(event){var $this=$(this),value=$this.val();""===value&&$this.hasClass("not_empty")&&$this.removeClass("not_empty"),""===value||$this.hasClass("not_empty")||$this.addClass("not_empty")})),$navsearchSubmit.on("mousedown",(function(event){event.preventDefault()})),$("#frmSearch").on("submit",(function(event){if("object"!=typeof this.search_query||""===this.search_query.value)return!1}))}(),$(".js-search").each((function(){var $search=$(this),$datepickerStart=$search.find(".datepicker-start"),$datepickerEnd=$search.find(".datepicker-end"),$rules=$search.find(".js-search-rules"),$rulesButton=$search.find(".js-search-rules-button"),$rulesNano=$rules.find(".nano"),$rulesNanoContent=$rulesNano.find(".nano-content"),$rulesClose=$rules.find(".js-search-rules-close"),$moreButton=$search.find(".js-search-more"),$clearButton=$search.find(".js-search-clear"),isRulesShown=!1,handlerKeydown=function(event){27!==event.keyCode||event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||(event.stopImmediatePropagation(),rulesHide())},handlerMousedown=function(event){rulesHide()},rulesHide=function(){isRulesShown&&($document.off("keydown",handlerKeydown),$document.off("mousedown touchstart",handlerMousedown),$rules.removeClass("search_rules_content--is_shown"),"function"==typeof $.fn.nanoScroller&&$rulesNano.nanoScroller({destroy:!0}),isRulesShown=!1)},updateClearButton=function(){$(".js-additional-holder.hide").each((function(){var $additionalHidden=$(this);$additionalHidden.find(".js-search-checkbox").prop("checked",!1),$additionalHidden.find(".datepicker-start, .datepicker-end").val("")})),$clearButton.prop("disabled",""===$datepickerStart.val()&&""===$datepickerEnd.val()&&0===$search.find(".js-search-checkbox:checked").length&&3===$search.find(".js-search-settings").find(".js-search-radio:first:checked").length)};1===$datepickerStart.length&&1===$datepickerEnd.length&&($datepickerStart.datepicker({changeMonth:!0,changeYear:!0,yearRange:"1990:c",minDate:new Date(1990,0,1),maxDate:0,beforeShow:function(){kommersant.sendEvent("search","click","date.from")},onClose:function(selectedDate){$datepickerEnd.datepicker("option","minDate",selectedDate)}}),$datepickerEnd.datepicker({changeMonth:!0,changeYear:!0,yearRange:"1990:c",minDate:$datepickerStart.datepicker("getDate"),maxDate:0,beforeShow:function(){kommersant.sendEvent("search","click","date.to")}})),$rules.on("mousedown touchstart",(function(event){event.stopPropagation()})),$rulesButton.on("mousedown touchstart",(function(event){isRulesShown&&event.stopPropagation()})),$rulesButton.on("click",(function(event){event.preventDefault(),isRulesShown?rulesHide():isRulesShown||($rules.addClass("search_rules_content--is_shown"),"function"==typeof $.fn.nanoScroller&&($rulesNano.nanoScroller({preventPageScrolling:!0,iOSNativeScrolling:!0}),$rulesNanoContent.focus()),$document.on("keydown",handlerKeydown),$document.on("mousedown touchstart",handlerMousedown),isRulesShown=!0,kommersant.sendEvent("search","click","rules")),event.detail&&$rulesButton.blur()})),$rulesClose.on("click",(function(event){event.preventDefault(),rulesHide()})),$moreButton.on("click",(function(event){kommersant.sendEvent("search","click","more")})),$clearButton.on("click",(function(event){event.preventDefault(),$search.find(".js-search-checkbox").prop("checked",!1),$search.find(".js-search-settings").find(".js-search-radio:first").trigger("click"),$datepickerStart.val(""),$datepickerEnd.val(""),updateClearButton(),kommersant.sendEvent("search","click","clear")})),$search.on("change",".js-search-radio, js-search-checkbox, .datepicker-start, .datepicker-end",(function(event){updateClearButton()})),$search.find(".js-search-radio").on("click",(function(event){event.which&&kommersant.sendEvent("search","click","options."+this.name+"."+this.value)})),updateClearButton()})),function(){var docsId=getDocsId();if(docsId){var paramParts,i,queryParts=window.location.search.slice(1).split("&"),query="";for(i=0;i<queryParts.length;i++)if("query"===(paramParts=queryParts[i].split("="))[0]){query=decodeURIComponent(paramParts[1]);break}if(query){$("#bankruptcyQuery").val(query);var isDoc=!!window.docsId;kommersant.utils.loadScript(kommersant.antiCache.jsMark).catch((function(){})),$.ajax({url:isDoc?"/search/GetDocWordForms":"/search/GetGalleryWordForms",method:"POST",data:{docsId:docsId,query:query},success:function(data){if(data.success&&data.WordForms.length&&data.WordForms.length){for(var i=0;i<data.WordForms.length;i++)data.WordForms[i]=data.WordForms[i].replace(/([/.*+?|()[\]{}\\])/g,"\\$1");kommersant.utils.loadScript(kommersant.antiCache.jsMark).then((function(){"function"==typeof $.fn.mark&&$(isDoc?".b-article > header, .article_text_wrapper":".gallery__header, .js-gallery-description, .js-gallery-resizable, .b-gallery > header, .b-gallery .b-gallery-pic_info__sign").markRegExp(new RegExp("(^|[^A-Za-zА-Яа-я0-9])("+data.WordForms.join("|")+")([^A-Za-zА-Яа-я0-9]|$)","g"),{ignoreGroups:1})}),(function(){}))}}})}}}(),$(".js-story").each((function(){var $story=$(this),$storyDigest=$story.find(".js-story-digest"),$storyDigestContent=$storyDigest.find(".js-story-digest-content"),$storyMore=$story.find(".js-story-more"),$storyMorePagesize=$story.find(".js-story-more-pagesize"),$storyMoreCount=$story.find(".js-story-more-count"),$loading=$(),themeId=$story.data("story-id")||"",pageSize=0,offset=0,iconCaptions={Note:"Заметка",PhotoGallery:"Фото",Video:"Видео"},iconTypes={Note:"article",PhotoGallery:"photogallery",Video:"video"},loadItems=function(){$storyMore.toggleClass("hide",!0),kommersant.templates.load().then((function(){($loading=$(kommersant.templates.apply("loading"))).appendTo($storyDigest);var data={id:themeId,offset:offset};pageSize>0&&(data.pageSize=pageSize),$.ajax({url:"/theme/storydocs",method:"GET",data:data,complete:function(){$loading.remove()},success:function(data){var href,date,timeZoneOffset,datetime,dateStr,imgSrc,imgSrcSetWebp,imgSrcSet,imgAlt,title,subTitle,intro,count,html="";if(data){if(pageSize<=0&&(pageSize=data.pageSize),offset=Math.min(data.offset+pageSize,data.count),count=Math.min(pageSize,data.count-offset),$storyMore.toggleClass("hide",offset>=data.count),$storyMorePagesize.html(count+" "+kommersant.utils.plural(count,"материал","материала","материалов")),$storyMoreCount.html(data.count),data.data&&data.data.length){for(var i=0;i<data.data.length;i++)data.data[i].id&&(href=("PhotoGallery"===data.data[i].type?"/gallery/":"/doc/")+data.data[i].id,timeZoneOffset=(date=kommersant.parseServerDate(data.data[i].date)).getTimezoneOffset(),datetime=date.getFullYear()+"-"+("0"+(date.getMonth()+1)).slice(-2)+"-"+("0"+date.getDate()).slice(-2)+"T"+("0"+date.getHours()).slice(-2)+":"+("0"+date.getMinutes()).slice(-2)+":"+("0"+date.getSeconds()).slice(-2)+(timeZoneOffset<=0?"+":"-")+("0"+Math.floor(Math.abs(timeZoneOffset)/60)).slice(-2)+":"+("0"+Math.abs(timeZoneOffset)%60).slice(-2),dateStr=("0"+date.getDate()).slice(-2)+"."+("0"+(date.getMonth()+1)).slice(-2)+(date.getFullYear()!==(new Date).getFullYear()?"."+date.getFullYear():"")+" | "+("0"+date.getHours()).slice(-2)+":"+("0"+date.getMinutes()).slice(-2),imgSrc=data.data[i].imgSrc&&data.data[i].imgSrc.indexOf("//")>=0&&data.data[i].imgSrc||"",imgSrcSetWebp=data.data[i].srcSetWebp||"",imgSrcSet=data.data[i].srcSet||"",imgAlt=data.data[i].imgAlt||"",title=data.data[i].title||"",subTitle=data.data[i].subTitle||"",intro=data.data[i].intro||"","News"===data.data[i].type?html+=kommersant.templates.apply("story-item-short",{href:href,time:isFinite(date)?kommersant.templates.apply("story-item-time",{datetime:datetime,dateStr:dateStr}):"",photo:imgSrc.length?kommersant.templates.apply("story-item-photo",{src:imgSrc,alt:imgAlt,srcset:imgSrcSetWebp&&imgSrcSet?kommersant.templates.apply("story-item-photo-srcset",{webp:imgSrcSetWebp,jpg:imgSrcSet}):""}):"",title:title.length?kommersant.templates.apply("story-item-title",{title:title}):"",intro:intro.length&&!imgSrc.length?kommersant.templates.apply("story-item-intro",{intro:intro}):""}):html+=kommersant.templates.apply("story-item-full",{href:href,tag:iconTypes[data.data[i].type]?kommersant.templates.apply("story-item-tag",{iconCaption:iconCaptions[data.data[i].type]||"",iconType:iconTypes[data.data[i].type]||""}):"",time:isFinite(date)?kommersant.templates.apply("story-item-time",{datetime:datetime,dateStr:dateStr}):"",photo:imgSrc.length?kommersant.templates.apply("story-item-photo",{src:imgSrc,alt:imgAlt,srcset:imgSrcSetWebp&&imgSrcSet?kommersant.templates.apply("story-item-photo-srcset",{webp:imgSrcSetWebp,jpg:imgSrcSet}):""}):"",title:title.length?kommersant.templates.apply("story-item-title",{title:title}):"",subtitle:subTitle.length?kommersant.templates.apply("story-item-subtitle",{subTitle:subTitle}):""}));$storyDigestContent.append(html)}}else $storyMore.toggleClass("hide",!1)},error:function(jqXHR,textStatus,errorThrown){$storyMore.toggleClass("hide",!1)}})}),(function(){}))};$storyMore.on("click",(function(event){event.preventDefault(),loadItems()})),$storyDigest.length>0&&$storyMore.length>0&&loadItems()})),$document.on("click",".review_slider__open, .review_slider__close",(function(event){event.preventDefault();var $button=$(this);$button.closest(".review_slider").toggleClass("is_expanded",$button.hasClass("review_slider__open")),$window.trigger("resize",!0)})),function(){var classBitrateItemSelected="fm_player__bitrate__item--selected",cookieOptions={domain:"."+kommersant.domain,path:"/",expires:kommersant.utils.dateAdd(new Date,6048e5)},$player=$(".fm_player");if($player.length){var cookieBitrate=kommersant.utils.getCookie("fmPlayerBitrate");""!==cookieBitrate?$player.each((function(){var $player=$(this),$audio=$player.find(".fm_player__controls"),$bitrateItems=$player.find(".fm_player__bitrate__item");$bitrateItems.each((function(){var $that=$(this);$that.text()!==cookieBitrate||$that.hasClass(classBitrateItemSelected)||($bitrateItems.removeClass(classBitrateItemSelected),$that.addClass(classBitrateItemSelected),$audio.prop("src",this.href))}))})):$player.each((function(){var $player=$(this),$audio=$player.find(".fm_player__controls"),$bitrateItems=$player.find(".fm_player__bitrate__item"),audioSrc=$audio.attr("src");$bitrateItems.each((function(){var $that=$(this);this.href!==audioSrc||$that.addClass(classBitrateItemSelected)}))})),$(".fm_player__bitrate__item").on("click",(function(event){event.preventDefault();var $that=$(this),$player=$that.closest(".fm_player"),$audio=$player.find(".fm_player__controls");$that.hasClass(classBitrateItemSelected)||(kommersant.utils.setCookie("fmPlayerBitrate",$that.text(),cookieOptions),$player.find("."+classBitrateItemSelected).removeClass(classBitrateItemSelected),$that.addClass(classBitrateItemSelected),$audio.prop("autoplay",!0),$audio.prop("src",this.href))}))}}(),$(".fm_announce").length&&kommersant.utils.loadScript(kommersant.antiCache.jsFmCommon).catch((function(){})),$document.on("click",".window-close",(function(event){event.preventDefault(),window.name!==kommersant.windowName||kommersant.isWebView||(window.open("","_self"),window.close())})),$document.on("click",".js-window-table",(function(event){event.preventDefault();var content=$(this).data("content");content&&kommersant.utils.windowOpen("",kommersant.windowName,800,680,content)})),$document.on("click",".captcha-reload",(function(event){event.preventDefault(),$.ajax({url:kommersant.personalHost+"/captcha/regenerate",method:"POST",success:function(data){$(".captcha").html(data)}})})),$(".b-stripe_numbers__expand").on("click",(function(event){$(".b-stripe_numbers").length>0&&(event.preventDefault(),$(".b-stripe_numbers").toggleClass("hide"))})),function(){var updateTable=function(table){var cellsCount,i,j,maxCellsCount=0,$table=$(table),$tbody=$table.children("tbody"),isSimplified=$table.hasClass("responsive_table--simplified"),minTableWidth=0;if($tbody.length&&window.getComputedStyle){var computedStyle=window.getComputedStyle($tbody.get(0),":after");if(computedStyle){var contentValue=computedStyle.getPropertyValue("content");'"'!==contentValue[0]&&"'"!==contentValue[0]||(contentValue=contentValue.slice(1,-1)),minTableWidth=parseInt(contentValue,10)||0}}if(0===minTableWidth){for(i=0;i<table.rows.length;i++){for(cellsCount=0,j=0;j<table.rows[i].cells.length;j++)cellsCount+=table.rows[i].cells[j].colSpan;cellsCount>maxCellsCount&&(maxCellsCount=cellsCount)}minTableWidth=100*maxCellsCount}$table.outerWidth(!0)<minTableWidth?isSimplified||$table.addClass("responsive_table--simplified"):isSimplified&&$table.removeClass("responsive_table--simplified")},resizeFunction=function(event){$(".responsive_table").not(":really-hidden").each((function(){updateTable(this)})),$(".responsive_table").not(":really-hidden").each((function(){var $that=$(this);$that.hasClass("responsive_table_ready")||($that.addClass("responsive_table_ready"),updateTable(this))}))};$window.on("resize",".responsive_table",updateTable),$window.on("kommersant:resize",resizeFunction),resizeFunction()}(),function(){if(!(window.location.search.slice(1).split("&").indexOf("lenta=0")>=0)){var docsId=getDocsId(),selectorRightBannerToReload=".adv3-16_240pxx400px";$(".js-lenta").each((function(){var relapRgid,count=0,$lenta=$(this),type=$lenta.data("lenta-type")||"",urlArchive=$lenta.data("lenta-archive")||"/archive",urlAjax="/doc/"+("article"===type?"doclazyload":"newslazyload")+"/",regionId=77,lentaIds=[],relapRids={},relapRgidFired=!1;"region"===type&&"object"==typeof docInfo&&"object"==typeof docInfo.region&&"number"==typeof docInfo.region.id&&isFinite(docInfo.region.id)&&docInfo.region.id>0&&(regionId=docInfo.region.id);var append=function(i){count++,kommersant.templates.load().then((function(){var html,url,$wrapper=$lenta,addJunk=function(i){var options1,options2,placeid,templateName;if(i!==lentaIds.length)switch(i%4){case 0:$lenta.find(".adv2-1_100x100px, .adv1-1_100x100px, .adv3-7_870pxx240px, .adv3-420-600pxx240px").find('div[id^="adfox_"]').prop("id","").removeAttr("id"),options1={before:1,after:50},options2={before:1,after:50},templateName="banner-103-"+regionId,kommersant.templates.exists(templateName)?options1.content=kommersant.utils.comment(kommersant.templates.apply(templateName)):options1.url="/common/bannernew?placeid=103&regionid="+regionId,templateName="banner-119-"+regionId,kommersant.templates.exists(templateName)?options2.content=kommersant.utils.comment(kommersant.templates.apply(templateName)):options2.url="/common/bannernew?placeid=119&regionid="+regionId,$wrapper.append('<div class="adv1-1_100x100px adv2-1_100x100px hide3">'+kommersant.templates.apply("lazyload",options1)+'</div><div class="adv3-420-600pxx240px hide1 hide2">'+kommersant.templates.apply("lazyload",options2)+"</div>");break;case 1:$lenta.find(".smi2_slider").prop("id","").removeAttr("id"),options1={before:1,after:50},templateName="banner-"+(placeid="article"===type?"148":"style"===type?"158":"161")+"-77",kommersant.templates.exists(templateName)?options1.content=kommersant.utils.comment(kommersant.templates.apply(templateName)):options1.url="/common/bannernew?placeid="+placeid+"&regionid=77",$wrapper.append(kommersant.templates.apply("lazyload",options1));break;case 2:$wrapper.append(kommersant.templates.apply("lazyload",{content:kommersant.utils.comment(kommersant.templates.apply("zen",{random:kommersant.utils.getRandomString()})),before:1,after:50}));break;case 3:$wrapper.append(kommersant.templates.apply("lazyload",{url:"region"===type&&[2,16,24,64].indexOf(regionId)<0?"/gbox/index/930/0/"+regionId:"/gbox/index/929/0/77",before:1,after:50}))}};i<lentaIds.length?(url=urlAjax+lentaIds[i],html="article"!==type&&i>0&&i%4==0?kommersant.templates.apply("lenta-button-more",{url:url}):kommersant.templates.apply("lazyload",{url:url,after:50,content:kommersant.templates.apply("loading")}),1===count&&"style"!==type&&(0===$(".b-article__social").length&&$wrapper.append(kommersant.templates.apply("lazyload",{url:"region"===type?"/gbox/index/779/0/"+regionId:"/gbox/index/777/0/77",before:1,after:50})),addJunk(i)),($wrapper=$('<div class="printable">')).one("kommersant:lazyload",(function(event){if($wrapper.off("kommersant:lazyloaderror"),$wrapper.find(".js-lenta-vvodka .b-article__intro").each((function(){var $intro=$(this),html=$intro.html(),found=html.indexOf("<br><br>");found>=0&&$intro.html(html.slice(0,found))})),kommersant.utils.applyCallbacks(kommersant.user.callbacksFavorites),kommersant.utils.applyCallbacks(kommersant.user.callbacksSubscriptions),"news"===type&&i+1===4){var $rightBanner1=$(".adv3-9_240pxx800px"),$rightBanner2=$(".adv3-16_240pxx400px");1===$rightBanner1.length&&1===$rightBanner2.length&&(kommersant.utils.swapNodes($rightBanner1.get(0),$rightBanner2.get(0)),selectorRightBannerToReload=".adv3-9_240pxx800px")}"region"!==type&&kommersant.advReload(selectorRightBannerToReload),addJunk(i+1),append(i+1)})),$wrapper.one("kommersant:lazyloaderror",(function(event){$wrapper.off("kommersant:lazyload"),lentaIds.splice(i,1),append(i)})),$wrapper.html(html),$wrapper.appendTo($lenta)):"article"!==type&&$lenta.append(kommersant.templates.apply("lenta-button-archive",{url:urlArchive})),$window.trigger("scroll")}))},removeFromArray=function(haystack,needle){if("object"==typeof haystack&&haystack.length){var index=haystack.indexOf(needle);index>=0&&haystack.splice(index,1)}};$lenta.on("click",".lazyload-button",(function(event){if("article"!==type&&loadRecommended(),"article"===type){var $article=$(this).closest(".js-article"),$articles=$lenta.find(".js-article");kommersant.sendEvent("lenta.doc","click.full",$articles.index($article)+1);var docsId=$article.data("article-docsid")||"";if(docsId&&relapRids[docsId])(new Image).src="https://relap.io/api/v2/pixel.gif?rid="+relapRids[docsId]}else kommersant.sendEvent("lenta","click","more")})),$lenta.on("kommersant:lazyload",(function(event){($(event.target).closest(".js-article").find(".js-lenta-vvodka").remove(),!relapRgidFired&&"article"===type&&relapRgid)&&((new Image).src="https://relap.io/api/v2/pixel.gif?rgid="+relapRgid,relapRgidFired=!0)})),"object"==typeof kommersant.backend.lentaIds&&kommersant.backend.lentaIds.length&&(lentaIds=lentaIds.concat(kommersant.backend.lentaIds)),removeFromArray(lentaIds,docsId),"article"===type?$.ajax({url:"https://relap.io/api/v2/similar_pages_jsonp.js",method:"GET",dataType:"jsonp",timeout:5e3,data:{url:canonical[0],limit:13,allowed_segments:["smartfeed"].join(",")},success:function(data){var i,lentaIdsIndex,id,result,relapIds=[],lentaIdsBefore=lentaIds.slice(0,1);if(data&&data.rec_group_id&&data.recs&&"object"==typeof data.recs&&data.recs.length)for(relapRgid=data.rec_group_id,i=0;i<data.recs.length;i++)(result=/kommersant\.ru\/doc\/([0-9]+)/.exec(data.recs[i].url))&&result[1]&&(id=parseInt(result[1],10)||0)&&-1===relapIds.indexOf(id)&&(relapIds.push(id),relapRids[id]=data.recs[i].rec_id,(lentaIdsIndex=lentaIds.indexOf(id))>=0&&lentaIds.splice(lentaIdsIndex,1));removeFromArray(lentaIds,lentaIdsBefore[0]),lentaIds=lentaIdsBefore.concat(relapIds,lentaIds)},complete:function(){removeFromArray(lentaIds,docsId),lentaIds=lentaIds.slice(0,13),append(0)}}):append(0)}))}}(),function(){var triggerOffset,isPaused=!1,classCurrent="js-canonical-current",canonicalItems=[],lastItem=null;if($(".js-canonical").length){history.scrollRestoration="manual";var getClosest=function(){if(!isPaused&&(triggerOffset=.5*$window.outerHeight(),canonicalItems=[],$(".js-canonical").each((function(){canonicalItems.push({element:this,offset:$(this).offset().top})})),canonicalItems.length)){var i,closest,newDistance,minNegative,minPositive,windowScrollTop=$window.scrollTop();for(i=0;i<canonicalItems.length;i++)(newDistance=canonicalItems[i].offset-windowScrollTop-triggerOffset)<=0?(void 0===minNegative||minNegative<newDistance)&&(minNegative=newDistance,closest=i):(void 0===minPositive||minPositive>newDistance)&&(minPositive=newDistance,void 0===closest&&(closest=i));if(closest!==lastItem){if($(canonicalItems[closest].element).each((function(){"article"===$(this).closest(".js-lenta").data("lenta-type")?kommersant.sendEvent("lenta.doc","show.article",closest+1):kommersant.sendEvent("lenta","show.article",closest+1)})),null===lastItem&&0===closest)return $(canonicalItems[closest].element).each((function(){$(this).addClass(classCurrent+" lenta__item--current")})),void(lastItem=closest);$("."+classCurrent).removeClass(classCurrent+" lenta__item--current"),$(canonicalItems[closest].element).each((function(){var $canonical=$(this),id=$canonical.data("article-docsid")||"",dateRFC822=$canonical.data("article-daterfc822")||"",publishingId=parseInt($canonical.data("article-publishing-id"),10)||0,publishingName=$canonical.data("article-publishing-name")||"",publishingUrl=$canonical.data("article-publishing-url")||"",rubricId=parseInt($canonical.data("article-rubric-id"),10)||0,rubricName=$canonical.data("article-rubric-name")||"",rubricUrl=$canonical.data("article-rubric-url")||"",sectionId=parseInt($canonical.data("article-section-id"),10)||0,sectionName=$canonical.data("article-section-name")||"",sectionUrl=$canonical.data("article-section-url")||"",regionId=parseInt($canonical.data("article-region-id"),10)||0,regionName=$canonical.data("article-region-name")||"",regionUrl=$canonical.data("article-region-url")||"",authors=$canonical.data("article-authors")||"",categories=$canonical.data("article-categories")||"",subcategories=$canonical.data("article-subcategories")||"",url=$canonical.data("canonical-url")||"",doctitle=$canonical.data("canonical-doctitle")||"",title=$canonical.data("canonical-title")||"",description=$canonical.data("canonical-description")||"",picture=$canonical.data("canonical-image")||"",ontheioDisabled=!!$canonical.data("ontheio-disabled"),relativeUrl=url.replace(/^(.*:)?\/\/[^\/]*/,"");window.doc.init({id:id}),document.title=doctitle,$head.find('meta[name="title"]').prop("content",doctitle),$head.find('meta[name="description"]').prop("content",description),$head.find('meta[name="keywords"]').prop("content",""),$head.find('link[rel="amphtml"]').prop("href",url.replace("/doc/","/amp/")),$head.find('meta[property="og:url"]').prop("content",url),$head.find('meta[property="og:title"]').prop("content",title),$head.find('meta[property="og:description"]').prop("content",description),$head.find('meta[property="og:image"]').prop("content",picture),$head.find('meta[name="twitter:title"]').prop("content",title),$head.find('meta[name="twitter:description"]').prop("content",description),$head.find('meta[name="twitter:image"]').prop("content",picture),$head.find('link[rel="image_src"]').prop("href",picture),$head.find('meta[property="article:published_time"]').prop("content",dateRFC822),$head.find('link[rel="canonical"]').prop("href",url),"replaceState"in history&&history.replaceState(null,doctitle,relativeUrl),$canonical.addClass(classCurrent+" lenta__item--current"),$(".js-canonical-favorites").data("user-favorites-id",id),kommersant.utils.applyCallbacks(kommersant.user.callbacksFavorites),kommersant.updateSocialButtons({url:url,title:title,description:description,picture:picture}),kommersant.user.logHistory(id,1),"object"==typeof docInfo&&(docInfo.publishing=0!==publishingId&&""!==publishingName&&""!==publishingUrl?{id:publishingId,name:publishingName,url:publishingUrl}:null,docInfo.rubric=0!==rubricId&&""!==rubricName&&""!==rubricUrl?{id:rubricId,name:rubricName,url:rubricUrl}:null,docInfo.section=0!==sectionId&&""!==sectionName&&""!==sectionUrl?{id:sectionId,name:sectionName,url:sectionUrl}:null,docInfo.region=0!==regionId&&""!==regionName&&""!==regionUrl?{id:regionId,name:regionName,url:regionUrl}:null,docInfo.authors=authors.length?authors.split(","):null,docInfo.categories=categories.length?categories.split(","):null,docInfo.subcategories=subcategories.length?subcategories.split(","):null,docInfo.dateRFC822=dateRFC822.length?dateRFC822:null,docInfo.refresh=!0,$window.trigger("scroll")),window.ioInfo=ontheioDisabled?null:{page_url:url,page_url_canonical:url,page_title:title,page_type:"article",page_language:"ru",article_authors:authors.length?authors.split(","):[],article_categories:categories.length?categories.split(","):[],article_subcategories:subcategories.length?subcategories.split(","):[],article_publication_date:dateRFC822},window.kommersantAnalytics=Object.assign(window.kommersantAnalytics||{},{rubrics:$canonical.data("analytics-rubrics")||"",publishing:$canonical.data("analytics-publishing")||"",themes:$canonical.data("analytics-themes")||"",themegroups:$canonical.data("analytics-themegroups")||"",authors:$canonical.data("analytics-authors")||"",audio:$canonical.data("analytics-audio")||"",liveinternet:$canonical.data("analytics-liveinternet")||""});try{countersUpdate()}catch(ignore){}loadRecommended()})),lastItem=closest}}};$document.on("click",".js-article-comment",(function(event){var $article=$(this).closest(".js-article");if(0===$article.length&&($article=$("."+classCurrent)),0!==$article.length){event.preventDefault();var fn=function(){if(void 0!==$.fn.comments){var $comments=$article.find(".comments");if(0===$comments.length){var objectId=parseInt($article.data("article-docsid"),10)||getDocsId();if(!objectId)return;($comments=$('<div class="comments"></div>')).appendTo($article),$comments.comments({project:1,objectType:1,objectId:objectId})}var isShown=kommersant.utils.dataBoolean($comments.data("shown"));isShown||($comments.removeClass("hide"),$comments.data("shown",!0));var offsetTop=$comments.offset().top,windowScrollTop=$window.scrollTop(),windowHeight=$window.outerHeight(),offset=$(".fixed_panel").height()||0;windowScrollTop+windowHeight-100<offsetTop||windowScrollTop>offsetTop-offset?$.scrollTo($comments,{margin:!0,offset:-offset}):isShown&&($comments.data("shown",!1),$comments.addClass("hide")),$window.trigger("scroll")}};void 0!==$.fn.comments?fn():(kommersant.vicons.add(kommersant.antiCache.viconsComments,{cache:!0}),kommersant.utils.loadStyle(kommersant.antiCache.cssComments),kommersant.utils.loadScript(kommersant.antiCache.jsComments).then((function(){fn()}),(function(){})))}})),"#comments"===window.location.hash&&0===$("#comments").length&&$(".js-article-comment").first().trigger("click"),$window.on("kommersant:resize kommersant:scroll",getClosest),getClosest(),$window.on("beforeprint",(function(event){isPaused=!0})),$window.on("afterprint",(function(event){isPaused=!1}))}}(),function(){var minYear,maxYear,minDate,maxDate,y,m;if("function"==typeof $.fn.datepicker){var inExistingDates,withinExistingDates,formatDate=function(date){return("0"+date.getDate()).slice(-2)+"."+("0"+(date.getMonth()+1)).slice(-2)+"."+("0"+date.getFullYear()).slice(-4)};if("undefined"!=typeof existingDates){for(inExistingDates=function(date){var year=date.getFullYear()-1990,month=date.getMonth(),day=date.getDate();return[existingDates&&existingDates[year]&&existingDates[year][month]&&-1!==existingDates[year][month].indexOf(day),""]},withinExistingDates=function(date){return date<=maxDate},y=0;y<existingDates.length;y++)if(!minYear&&existingDates[y]&&(minYear=1990+y),existingDates[y])for(m=0;!minDate&&m<existingDates[y].length;m++)existingDates[y][m]&&(minDate=new Date(y+1990,m,existingDates[y][m][0]));y=existingDates.length-1,m=existingDates[existingDates.length-1].length-1,maxYear=y+1990,maxDate=new Date(maxYear,m,existingDates[y][m][existingDates[y][m].length-1])}else inExistingDates=function(){return!0},withinExistingDates=function(){return!0},minYear=1990,maxYear=(new Date).getFullYear(),minDate=new Date(minYear,0,1),maxDate=0;$(".datepicker-archive-day").each((function(){var $datepicker=$(this),options={changeMonth:!0,changeYear:!0,yearRange:minYear+":"+maxYear,minDate:minDate,maxDate:maxDate,onSelect:function(dateText,inst){$(this.form).submit()}};"undefined"!=typeof existingDates&&(options.beforeShowDay=inExistingDates),$datepicker.datepicker(options)})),$(".datepicker-archive-week").each((function(){var currentMin,currentMax,$datepicker=$(this),setValue=function(value){var parts=value.match(/^([0-9]{2})\.([0-9]{2})\.([0-9]{4}) — ([0-9]{2})\.([0-9]{2})\.([0-9]{4})$/);if(parts&&(currentMin=new Date(parseInt(parts[3],10),parseInt(parts[2],10)-1,parseInt(parts[1],10))),!parts||isNaN(currentMin.valueOf())){var now=new Date;currentMin=new Date(now.getFullYear(),now.getMonth(),now.getDate())}return currentMin.setDate(currentMin.getDate()-(currentMin.getDay()+6)%7),(currentMax=new Date(currentMin)).setDate(currentMax.getDate()+6),formatDate(currentMin)+" — "+formatDate(currentMax)},options={changeMonth:!0,changeYear:!0,showOtherMonths:!0,yearRange:minYear+":"+maxYear,minDate:minDate,maxDate:maxDate,dateFormat:"dd.mm.yy — dd.mm.yy",beforeShow:function(input,inst){input.value=setValue(input.value)},beforeShowDay:function(date){return date-currentMin>=0&&date-currentMax<=0?[!0,"ui-datepicker-current"]:inExistingDates(date)},onSelect:function(dateText){$(this).val(setValue(dateText)),$(this.form).submit()}};$datepicker.datepicker(options)})),$(".datepicker-archive-month").each((function(){var currentMin,currentMax,$datepicker=$(this),setValue=function(value){var parts=value.match(/^([0-9]{2})\.([0-9]{2})\.([0-9]{4}) — ([0-9]{2})\.([0-9]{2})\.([0-9]{4})$/);if(parts&&(currentMin=new Date(parseInt(parts[3],10),parseInt(parts[2],10)-1,parseInt(parts[1],10))),!parts||isNaN(currentMin.valueOf())){var now=new Date;currentMin=new Date(now.getFullYear(),now.getMonth(),1)}return currentMin.setDate(1),(currentMax=new Date(currentMin)).setMonth(currentMax.getMonth()+1),currentMax.setDate(0),formatDate(currentMin)+" — "+formatDate(currentMax)},options={changeMonth:!0,changeYear:!0,yearRange:minYear+":"+maxYear,minDate:minDate,maxDate:maxDate,dateFormat:"dd.mm.yy — dd.mm.yy",beforeShow:function(input,inst){input.value=setValue(input.value)},beforeShowDay:function(date){return date-currentMin>=0&&date-currentMax<=0?[!0,"ui-datepicker-current"]:inExistingDates(date)},onSelect:function(dateText){$(this).val(setValue(dateText)),$(this.form).submit()}};$datepicker.datepicker(options)})),$(".js-archive-form").each((function(){var $form=$(this);$form.on("submit",(function(event){event.preventDefault();var value=$form.find(".datepicker").val(),yyyymmdd=value.slice(6,10)+"-"+value.slice(3,5)+"-"+value.slice(0,2),nodesid=parseInt($form.find("input[name=nodesid]:checked").val()||"",10)||0;-1!==yyyymmdd.search(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/)&&(window.location.href=this.action+yyyymmdd+(nodesid?"?nodesid="+nodesid:""))})),$form.find(".js-archive-next").each((function(){var $next=$(this),href=$next.data("href")||"",matches=href.match(/(\d{4})-(\d{2})-(\d{2})/);if(matches){var date=new Date(parseInt(matches[1],10),parseInt(matches[2],10)-1,parseInt(matches[3],10));withinExistingDates(date)&&$next.attr("href",href)}}))}))}}(),function(){var notification;$document.on("click",".user-login",(function(event){event.preventDefault(),kommersant.user.logout(),kommersant.user.login(),kommersant.sendEvent("user","click","login")})),$document.on("click",".user-register",(function(event){event.preventDefault(),kommersant.user.logout(),kommersant.user.register(),kommersant.sendEvent("user","click","register")})),$document.on("click",".user-social",(function(event){event.preventDefault();var $this=$(this),socialNetwork=parseInt($this.data("user-source"),10)||0,isAlias=void 0!==$this.data("user-alias");kommersant.user.social(1,socialNetwork,isAlias)})),$document.on("click",".user-logout",(function(event){event.preventDefault(),kommersant.user.logout(),kommersant.sendEvent("user","click","logout")})),$document.on("click",".user-favorites",(function(event){var $that=$(this),isCheckbox="checkbox"===this.type,action=$that.data("user-favorites-action"),id=parseInt($that.data("user-favorites-id"),10)||0,type=parseInt($that.data("user-favorites-type"),10)||0;isCheckbox?action=this.checked?"add":"del":event.preventDefault(),kommersant.user.isAuthorized?kommersant.user.favoritesManage(id,type,isCheckbox?!this.checked:"del"===action,(function(){kommersant.sendEvent("user","favorites",action)}),(function(error){new kommersant.Notification(error)})):(notification&&!notification.isClosed||(notification=new kommersant.Notification('Кто Вы? <a href="#" class="user-register">Зарегистрируйтесь</a> или <a href="#" class="user-login">войдите</a>, чтобы добавить в Избранное.',{autoClose:!0,autoCloseTimeout:1e4})),kommersant.utils.applyCallbacks(kommersant.user.callbacksFavorites))})),$document.on("click",".user-subscriptions",(function(event){var that=this,$that=$(that),isCheckbox="checkbox"===that.type,action=$that.data("user-subscriptions-action"),id=parseInt($that.data("user-subscriptions-id"),10)||0,type=parseInt($that.data("user-subscriptions-type"),10)||0;isCheckbox?action=that.checked?"add":"del":event.preventDefault(),kommersant.user.isAuthorized?kommersant.user.subscriptionsManage(id,type,isCheckbox?!that.checked:"del"===action,(function(){kommersant.sendEvent("user","subscriptions",action),isCheckbox&&that.checked||!isCheckbox&&"add"===action?(notification&&!notification.isClosed||(notification=kommersant.user.data.Email?kommersant.user.subscriptionsNotify?new kommersant.Notification("Вы успешно подписаны. Теперь уведомления о свежих материалах будут приходить Вам на e-mail "+kommersant.user.data.Email+'. Изменить настройки подписки Вы можете в <a href="'+kommersant.user.urlSubscriptionSettings+'" target="_blank">личном кабинете</a>'):new kommersant.Notification('Для получения уведомлений о свежих материалах в почту измените настройки e-mail уведомлений в <a href="'+kommersant.user.urlSubscriptionSettings+'" target="_blank">личном кабинете</a>'):new kommersant.Notification('Укажите в <a href="'+kommersant.user.urlProfileEdit+'" target="_blank">профиле</a> свой e-mail, чтобы получать уведомления о свежих материалах в почту. Настройками подписки Вы можете управлять в <a href="'+kommersant.user.urlSubscriptionSettings+'" target="_blank">личном кабинете</a>')),3===type&&kommersant.sendYa("goal","user_subscribe_theme"),4===type&&kommersant.sendYa("goal","user_subscribe_author")):notification&&!notification.isClosed&&notification.close()}),(function(error){new kommersant.Notification(error)})):(notification&&!notification.isClosed||(notification=new kommersant.Notification('Кто Вы? <a href="#" class="user-register">Зарегистрируйтесь</a> или <a href="#" class="user-login">войдите</a>, чтобы подписаться на уведомления.',{autoClose:!0,autoCloseTimeout:1e4})),kommersant.utils.applyCallbacks(kommersant.user.callbacksSubscriptions))})),$document.on("click",".user-email-author",(function(event){kommersant.user.isAuthorized||(event.preventDefault(),notification&&!notification.isClosed||(notification=new kommersant.Notification('Кто Вы? <a href="#" class="user-register">Зарегистрируйтесь</a> или <a href="#" class="user-login">войдите</a>, чтобы написать автору.',{autoClose:!0,autoCloseTimeout:1e4})))}));kommersant.user.callbacksAuthorized.push((function(){$(".js-auth").addClass("is_active").toggleClass("is_authorized",kommersant.user.isAuthorized)})),kommersant.user.callbacksAlias.push((function(){$(".user-social").each((function(){var $this=$(this),socialNetwork=parseInt($this.data("user-source"),10)||0;if(void 0!==$this.data("user-alias")&&socialNetwork===kommersant.user.alias){var $togglable=$this.closest(".togglable");$togglable.removeClass("togglable--0"),$togglable.addClass("togglable--1")}}))})),kommersant.user.callbacksNotifications.push((function(){$(".js-auth-notifications").toggleClass("hide",!kommersant.user.notifications.count).html(kommersant.user.notifications.count||"")})),kommersant.user.callbacksFavorites.push((function(){$(".user-favorites").each((function(){var $this=$(this),result=kommersant.user.isAuthorized;if(result){var id=parseInt($this.data("user-favorites-id"),10),type=parseInt($this.data("user-favorites-type"),10);result=kommersant.utils.inArray(id,kommersant.user.getTypedArray(type))}if("checkbox"===this.type)this.checked=result;else{if("del"===$this.data("user-favorites-action"))return;var $togglable=$this.closest(".togglable");$togglable.toggleClass("togglable--0",!result),$togglable.toggleClass("togglable--1",result)}}))})),kommersant.user.callbacksSubscriptions.push((function(){$(".user-subscriptions").each((function(){var $this=$(this),result=kommersant.user.isAuthorized;if(result){var id=parseInt($this.data("user-subscriptions-id"),10),type=parseInt($this.data("user-subscriptions-type"),10);result=kommersant.utils.inArray(id,kommersant.user.getTypedArray(type))}if("checkbox"===this.type)this.checked=result;else{if("del"===$this.data("user-subscriptions-action"))return;var $togglable=$this.closest(".togglable");$togglable.toggleClass("togglable--0",!result),$togglable.toggleClass("togglable--1",result)}}))})),kommersant.user.callbacksDestroy.push((function(){$(".js-auth").removeClass("is_active is_authorized")})),kommersant.user.init(1)}(),function(){var $socialPanel=$(".fixed_panel"),$searchInput=$(".fixed_panel__search_input"),$searchSubmitButton=$(".search_panel__submit_button"),$popupMenu=$(".popup_menu"),$popupMenuInner=$(".popup_menu__inner"),$popupMenuToggle=$(".popup_menu__toggle"),$popupMenuClose=$(".popup_menu__close"),isTriggerClicked=!1,isSocialPanelShown=!1,isPopupMenuShown=!1,socialPanelToggle=function(isShown){if("boolean"==typeof isShown){if(isShown===isSocialPanelShown)return}else isShown=!isSocialPanelShown;$socialPanel.toggleClass("fixed_panel--is_shown",isShown),$(document.body).toggleClass("fixed_panel_shown",isShown),isSocialPanelShown=isShown,kommersant.sendEvent("fixed_menu","visibility",isShown?"show":"hide")},popupMenuToggle=function(isShown){if("boolean"==typeof isShown){if(isShown===isPopupMenuShown)return}else isShown=!isPopupMenuShown;$popupMenu.toggleClass("popup_menu--is_shown",isShown),isPopupMenuShown=isShown,isShown?($document.on("keydown",popupMenuKeydown),$document.on("mousedown touchstart",popupMenuMousedown)):($popupMenuInner.scrollTop(0),$document.off("keydown",popupMenuKeydown),$document.off("mousedown touchstart",popupMenuMousedown)),kommersant.sendEvent("popup_menu","visibility",isShown?"show":"hide")},popupMenuKeydown=function(event){27!==event.keyCode||event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||(event.stopImmediatePropagation(),popupMenuToggle(!1))},popupMenuMousedown=function(event){popupMenuToggle(!1)};function headerIsVisible(){var $header=$(".main_header"),articleOffset=$(".b-article:first").offset(),headerOffset=$header.offset(),headerHeight=$header.height(),pageOffset=window.pageYOffset,currentOffset=0;if(void 0===pageOffset||void 0===articleOffset&&(void 0===headerOffset||void 0===headerHeight))return!0;return articleOffset&&articleOffset.top&&articleOffset.top>0?currentOffset=articleOffset.top:headerOffset&&headerOffset.top&&headerOffset.top>0&&headerHeight&&headerHeight>0&&/^\/doc\//i.test(window.location.pathname)&&(currentOffset=headerOffset.top+headerHeight),!(currentOffset>0)||pageOffset<currentOffset}$popupMenuToggle.length&&$popupMenu.length&&($popupMenuToggle.on("click",(function(event){event.preventDefault(),popupMenuToggle()})),$popupMenuClose.on("click",(function(event){event.preventDefault(),popupMenuToggle(!1)})),$popupMenu.on("click mousedown touchstart",(function(event){event.stopPropagation()})),$popupMenuToggle.on("mousedown touchstart",(function(event){event.stopPropagation()})),$socialPanel.length&&(headerIsVisible()||socialPanelToggle(!0),$searchInput.on("keyup",(function(evt){27==evt.keyCode&&$searchInput.trigger("blur")})),$searchInput.on("focus",(function(){$searchInput.select(),$socialPanel.addClass("fixed_panel--search_active")})),$searchInput.on("blur",(function(){$socialPanel.removeClass("fixed_panel--search_active")})),$searchSubmitButton.on("click",(function(evt){$searchInput.val()&&$("#fake-search-form").submit()})),$("#fake-search-form").on("submit",(function(evt){evt.stopPropagation(),evt.preventDefault();var inputVal=$searchInput.val(),$mainSearchInput=$("#navsearch-query");inputVal&&($mainSearchInput.val(inputVal),$("#navsearch-form").submit())})),$window.on("scroll",(function(){headerIsVisible()?isTriggerClicked||socialPanelToggle(!1):(socialPanelToggle(!0),isTriggerClicked=!1)}))))}(),function(){var timer,selectedTextLast="",isMouseDown=!1,isVisible=!1;if($(".article_text_wrapper").length){var addPartialSharing=function(description,pageX,pageY){kommersant.templates.load().then((function(){var $item,i,$shareBlock=$(kommersant.templates.apply("partialsharing",{top:pageY,left:pageX})),networks=["vk","ok","tw"];for(i=0;i<networks.length;i++)($item=$(kommersant.templates.apply("partialsharing-item",{network:networks[i]}))).find(".socials-link").each((function(){var $socialsLink=$(this);$socialsLink.data("socials-network",networks[i]),$socialsLink.data("socials-picture","//im.kommersant.ru/contentflex/images/logos/logo_quote.jpg"),$socialsLink.data("socials-description",description)})),$shareBlock.append($item);$body.append($shareBlock),$shareBlock.on("mousedown",(function(evt){evt.stopPropagation(),evt.preventDefault()})),$shareBlock.find(".socials-link").each((function(){kommersant.utils.triggerCustomEvent(this,"kommersant:click")})),$shareBlock.on("click",".socials-link",(function(event){var network=$(this).data("socials-network")||"";requestAnimationFrame(removePartialSharing),kommersant.sendEvent("partialsharing","click",network)})),function($element,pageX,pageY){var windowWdth=$window.width(),windowHeight=$window.height(),offset=$element.offset(),wd=$element.outerWidth(!0),hg=$element.outerHeight(!0),offset_top=offset.top,scrollTopWind=$window.scrollTop(),topOverflow=scrollTopWind-offset_top,bottomOverFlow=offset_top+hg-(scrollTopWind+windowHeight),rightOverflow=windowWdth-(pageX+wd);rightOverflow<0&&(pageX+=rightOverflow),(topOverflow=-(topOverflow+=$(".fixed_panel").height()))<0&&(pageY-=topOverflow),bottomOverFlow>0&&(pageY-=bottomOverFlow),$element.css({left:pageX,top:pageY})}($shareBlock,pageX,pageY),isVisible=!0,kommersant.sendEvent("partialsharing","visibility","show")}),(function(){}))},removePartialSharing=function(){isVisible&&($(".partial_sharing").remove(),isVisible=!1,kommersant.sendEvent("partialsharing","visibility","hide"))},timerFn=function(){if(clearTimeout(timer),isMouseDown)return setTimer();var slc=window.getSelection();if(!slc||!slc.rangeCount)return removePartialSharing(),setTimer();var text,isTooLong,s_,selectedText=slc.toString();if(selectedText.length<5)return removePartialSharing(),setTimer();if(selectedText&&selectedText.length){if(selectedTextLast===selectedText)return setTimer();selectedTextLast=selectedText,removePartialSharing();var elJ=$(slc.focusNode.parentNode);if(!elJ.closest(".article_text_wrapper").length||elJ.closest(".js-chart, .js-widget").length)return setTimer();var oRect=slc.getRangeAt(0).getBoundingClientRect(),scrollTopWind=$window.scrollTop();addPartialSharing((isTooLong=(text=selectedText).length>120,s_=isTooLong?text.substr(0,117):text,isTooLong?s_.substr(0,s_.lastIndexOf(" "))+"...":s_),oRect.left,scrollTopWind+oRect.top)}else removePartialSharing();return setTimer()},setTimer=function(){timer=setTimeout(timerFn,33)};$document.on("mousedown",(function(event){1===event.which&&(isMouseDown=!0,removePartialSharing())})),$document.on("mouseup",(function(event){isMouseDown&&1===event.which&&(isMouseDown=!1)})),$document.on("mousemove",(function(event){isMouseDown&&1!==event.which&&(isMouseDown=!1)})),$document.on("keydown",(function(event){27!==event.keyCode||event.ctrlKey||event.altKey||event.shiftKey||event.metaKey||$(".partial_sharing").length&&(event.stopImmediatePropagation(),removePartialSharing())})),$window.on("kommersant:resize",(function(event){selectedTextLast=""})),setTimer()}}(),$(".main_header").length&&kommersant.templates.load().then(kommersant.prepareFixed).then((function(){$(".fixed_bottom__item--buttons").append(kommersant.templates.apply("upbutton"));var $upButton=$(".up_button");if($upButton.length){var timer,vpWidth=$window.width(),lastScrollTop=0,continuous=0,isButtonShown=!1,isScrolling=!1,upButtonHide=function(){clearTimeout(timer),!isScrolling&&isButtonShown&&($upButton.removeClass("is_shown"),isButtonShown=!1)},upButtonUpdate=function(){requestAnimationFrame((function(){var topOffset=$window.scrollTop(),vpHeight=$window.outerHeight(),delta=topOffset-lastScrollTop;if(0!==delta){(delta>0&&continuous<0||delta<0&&continuous>0)&&(continuous=0),continuous+=delta;var isSecondScreen=topOffset>1.2*vpHeight;Math.abs(continuous)>=30&&(isSecondScreen&&continuous<0?(clearTimeout(timer),isScrolling||(isButtonShown||($upButton.addClass("is_shown"),isButtonShown=!0),vpWidth<1100&&(timer=setTimeout(upButtonHide,3e3)))):upButtonHide()),lastScrollTop=topOffset}}))};$upButton.on("click",(function(event){event.preventDefault(),upButtonHide(),isScrolling=!0;var onComplete=function(){isScrolling=!1};$window.stop().scrollTo(0,{onAfter:function(){onComplete()},fail:function(){$window.scrollTop(0),onComplete()}})})),$window.on("resize",(function(event){vpWidth=$window.width(),upButtonUpdate()})),$window.on("scroll",(function(event){upButtonUpdate()}))}}),(function(){})),function(){if(!/\/apps\//.test(window.location)){var $large=$(".js-middle").parent();if($large.length&&!$(".js-lenta").length){var $right=$(".js-rightside"),$rightBlocks=$right.children();if($right.length&&$rightBlocks.length){var check=function(isShrunk){var i,$block,largeHeight=$large.height(),rightHeight=$right.height();if(largeHeight>0&&rightHeight>largeHeight&&"phone"!==kommersant.media&&"tablet"!==kommersant.media){for(i=$rightBlocks.length-1;i>=0;i--)if(!($block=$rightBlocks.eq(i)).hasClass("js-hide")&&!$block.hasClass("hide")){$block.addClass("hide js-hide"),$right.offset(),check(!0);break}}else if(!isShrunk){if(!($block=$rightBlocks.filter(".js-hide").first()).length)return;$block.removeClass("hide js-hide"),$right.offset(),$window.trigger("resize"),check()}};$window.on("kommersant:resize",(function(event){check()})),setInterval(check,2e3)}}}}(),function(){var stickyItems=[{name:"left",$stickyContainer:$("#stickyLeft"),$asideContainer:$(".js-leftside").first(),$centralContainer:$(".js-middle").first(),docMinHeight:"",contentHeight:540,haveTopPadding:!0,isSticky:!1},{name:"right",$stickyContainer:$("#stickyRight"),$asideContainer:$(".js-rightside").first(),$centralContainer:$(".js-middle").parent(),docMinHeight:3250,contentHeight:400,haveTopPadding:!0,isSticky:!1},{name:"rightMain",$stickyContainer:$("#stickyRight"),$asideContainer:$(".js-rightside").first(),$centralContainer:$(".js-middleBottom").first(),docMinHeight:"",contentHeight:400,haveTopPadding:!1,isSticky:!1},{name:"left2Col",$stickyContainer:$("#stickyLeft"),$asideContainer:$(".js-leftside").first(),$centralContainer:$(".js-2col").first(),docMinHeight:"",contentHeight:540,haveTopPadding:!0,isSticky:!1}];function makeBlockSticky(){$.each(stickyItems,(function(key,item){!function(item){if(function(item){return!item.$stickyContainer||item.$stickyContainer.length<=0||!item.$asideContainer||item.$asideContainer.length<=0||!item.$centralContainer||item.$centralContainer.length<=0}(item))return;if(bodyType=window.getComputedStyle?window.getComputedStyle(document.body,":after").getPropertyValue("content"):"",!/desktop/i.test(bodyType))return void item.$stickyContainer.css({height:""});var bodyType;var stickyContainerHeight=item.$stickyContainer.height()||0,stickyContentHeight=item.$stickyContainer.children().height()||0,asideContainerHeight=item.$asideContainer.height()||0,centralContainerHeight=item.$centralContainer.height()||0,asideContainerRawHeight=asideContainerHeight-stickyContainerHeight;if(asideContainerHeight<=0)return;var newHeight=centralContainerHeight-asideContainerRawHeight;if(stickyContentHeight<=0||centralContainerHeight<asideContainerRawHeight||newHeight<stickyContentHeight)return item.$stickyContainer.height(0),void item.$stickyContainer.css({overflow:"hidden"});item.$stickyContainer.height(newHeight),item.$stickyContainer.css({overflow:""})}(stickyItems[key])}))}$window.on("resize",makeBlockSticky),setInterval(makeBlockSticky,2e3)}(),$window.on("resize",(function(){var $priorityStickyBlock=$(".sticky_priority"),$stickyBlock=$(".sticky_box");if($priorityStickyBlock.length&&$stickyBlock.length){var priorityHeight=$priorityStickyBlock.outerHeight(!0);if(priorityHeight&&!(priorityHeight<=0)){var $styleElement=$("#sticky-right-style"),styleText=".sticky_low_priority { top: "+priorityHeight+"px; } .fixed_panel_shown .sticky_low_priority { top: "+(priorityHeight+58)+"px; }";if($styleElement.length)$styleElement.text(styleText);else{var style=document.createElement("style");style.id="sticky-right-style",style.type="text/css",style.appendChild(document.createTextNode(styleText)),document.head.appendChild(style)}}}})),kommersantInit(),function(){$(".fixed_panel").length&&($document.on("click",".popup_menu__toggle",(function(){kommersant.sendEvent("fixed_menu","click","menu")})),$document.on("focus",".fixed_panel__search_input",(function(){kommersant.sendEvent("fixed_menu","click","search")}))),$(".article_sharing").length&&($document.on("click",".article_sharing .user-favorites",(function(){kommersant.sendEvent("article","click","favorites")})),$document.on("click",'.article_sharing a[href="#comments"]',(function(){kommersant.sendEvent("article","click","comments")})),$document.on("click",".article_sharing .socials-link",(function(){var network=$(this).data("socials-network")||"";""!==network&&"ml"!==network&&kommersant.sendEvent("article","click",network)}))),$document.on("click",'.b-article__button[href="#comments"]',(function(){kommersant.sendEvent("article","click","comments")})),$document.on("click",".b-newsline__menu_item__more",(function(){kommersant.sendEvent("news","click","more")})),$(".js-lenta").each((function(){var $lenta=$(this),isArticle="article"===($lenta.data("lenta-type")||"");$window.on("kommersant:resize kommersant:scroll",(function(){kommersant.utils.checkInViewport($lenta.find(".lazyload-button"),(function(){if(isArticle){var $article=$(this).closest(".js-article"),$articles=$lenta.find(".js-article");kommersant.sendEvent("lenta.doc","show.full",$articles.index($article)+1)}else kommersant.sendEvent("lenta","show","more")}))}))})),$("#footer").on("click",".network a",(function(){kommersant.sendEvent("footer","click",this.href)}));var $videoDigest=$(".video_digest");if($videoDigest.length>0){var types=["recommended","popular","all"];$videoDigest.each((function(i){$(this).find(".slider").slider("on","change",(function(index,id,reason){kommersant.sendEvent("video-digest-"+types[i],"slider."+reason,id)}))})),$window.on("kommersant:resize kommersant:scroll",(function(){$videoDigest.each((function(i,element){kommersant.utils.checkInViewport(element,(function(){kommersant.sendEvent("video-digest-"+types[i],"show")}))}))}))}$(".js-archive-form").length>0&&($window.on("kommersant:resize kommersant:scroll",(function(){kommersant.utils.checkInViewport("#filter_list",(function(){kommersant.sendEvent("archive","show","all")}))})),$document.on("click","#filter_list .search_filter__input",(function(event){var $input=$(this),value=parseInt($input.val(),10);isNaN(value)||kommersant.sendEvent("archive","click",{0:"all",999:"hot",47:"strana",2:"politika",6:"proicshestviya",7:"obschestvo",5:"mir",3:"ekonomika",4:"biznes",48:"promyshlennost",41:"potrebrynok",40:"finansi",75:"nedvizimost",8:"kultura",9:"sport",80:"hitech",68:"auto"}[value])}))),"undefined"!=typeof docInfo&&docInfo.publishing&&docInfo.publishing.id&&210===docInfo.publishing.id&&$(".b-incut_audio audio").each((function(){this.addEventListener("playing",(function(){kommersant.sendEvent("doc_fm","play")}),!0)}))}()}))}(jQuery);