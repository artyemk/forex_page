function _jsload(src){var sc=document.createElement("script");sc.type="text/javascript";sc.async=true;sc.src=src;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(sc,s);};(function(){document.getElementById("unit_94087").innerHTML="<div class=\"container-94087\"> <div class=\"container-94087__header\"> <a class=\"container-94087__header-logo-link\" href=\"https://smi2.ru/\" target=\"_blank\"> <img class=\"container-94087__header-logo\" src=\"//static.smi2.net/static/logo/smi2.svg\" alt=\"smi2\"> </a> </div> <div class=\"container-94087__frame-wrap\"> <div class=\"container-94087__frame\"> <div class=\"list-container\" id=\"container-94087\"></div> </div> <div class=\"container-94087__edge container-94087__edge-left\"> <div class=\"container-94087__edge-button container-94087__edge-button-left\"> <div class=\"container-94087__edge-button-arrow container-94087__edge-button-arrow-left\"></div> </div> <div class=\"container-94087__edge-shadow container-94087__edge-shadow-left\"></div> </div> <div class=\"container-94087__edge container-94087__edge-right\"> <div class=\"container-94087__edge-button container-94087__edge-button-right\"> <div class=\"container-94087__edge-button-arrow container-94087__edge-button-arrow-right\"></div> </div> <div class=\"container-94087__edge-shadow container-94087__edge-shadow-right visible\"></div> </div> </div> </div><style>.container-94087 { -webkit-box-sizing: border-box; box-sizing: border-box; position: relative; margin: 20px 0; } .container-94087__header { margin-bottom: 5px; height: 24px; overflow: hidden; text-align: left; } .container-94087__header-text { display: none; } .container-94087__header-logo { display: inline-block; vertical-align: top; height: 24px; width: auto; border: none; } .container-94087 .list-container { font-size: 0; width: 4144px; -webkit-transition: -webkit-transform .8s; transition: -webkit-transform .8s; transition: transform .8s; transition: transform .8s, -webkit-transform .8s; } .container-94087 .list-container-item { display: inline-block; vertical-align: top; width: 192px; -webkit-box-sizing: border-box; box-sizing: border-box; margin-right: 16px; -webkit-transition: -webkit-box-shadow; transition: -webkit-box-shadow; -o-transition: box-shadow; transition: box-shadow; transition: box-shadow, -webkit-box-shadow; -webkit-transition-duration: 0.8s; -o-transition-duration: 0.8s; transition-duration: 0.8s; -webkit-transition-property: -webkit-box-shadow; transition-property: -webkit-box-shadow; -o-transition-property: box-shadow; transition-property: box-shadow; transition-property: box-shadow, -webkit-box-shadow; will-change: box-shadow; border-radius: 4px; } .container-94087 .list-container-item:hover { -webkit-box-shadow: 0 0 6px 0 rgba(0,0,0,0.2), 0 4px 10px 0 rgba(0,0,0,0.5); box-shadow: 0 0 6px 0 rgba(0,0,0,0.2), 0 4px 10px 0 rgba(0,0,0,0.5); } .container-94087 .list-container-item:last-child { margin-right: 0; } .container-94087__img-link { display: block; width: 100%; height: 256px; position: relative; border-radius: 4px; overflow: hidden; } .container-94087__img { border: none; position: absolute; top: 0px; left: 0px; right: 0px; bottom: 0px; background-repeat: no-repeat; background-position: center center; background-size: cover; height: 200px; } .container-94087__text { position: absolute; bottom: 0; left: 0; right: 0; } .container-94087__gradient { height: 50px; background: -webkit-gradient(linear, left bottom, left top, from(rgb(38, 38, 38)), to(rgba(0, 0, 0, 0))); background: -webkit-linear-gradient(bottom, rgb(38, 38, 38) 0%, rgba(0, 0, 0, 0) 100%); background: -o-linear-gradient(bottom, rgb(38, 38, 38) 0%, rgba(0, 0, 0, 0) 100%); background: linear-gradient(to top, rgb(38, 38, 38) 0%, rgba(0, 0, 0, 0) 100%); } .container-94087__title-wrap { -webkit-box-sizing: border-box; box-sizing: border-box; width: 100%; padding: 0 15px 15px; background-color: rgb(38, 38, 38); } .container-94087__title { font-family: Arial, sans-serif; font-size: 16px; line-height: 19px; font-weight: bold; color: #fff; text-decoration: none; text-align: left; word-wrap: break-word; max-height: 114px; min-height: 57px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 6; -webkit-box-orient: vertical; } /*************/ .container-94087__frame-wrap { position: relative; width: 700px; height: 276px; padding: 10px 0 10px; overflow: hidden; width: 100%; -webkit-box-sizing: border-box; box-sizing: border-box; } .container-94087__frame { width: 100%; height: 300px; overflow-x: scroll; position: relative; -webkit-overflow-scrolling: touch; } /*--------------------------------------------------------*/ .container-94087__edge { width: 5px; position: absolute; top: 0px; bottom: 0px; z-index: 1; will-change: transform; -webkit-transform: translateZ(0); transform: translateZ(0); } .container-94087__edge-left { left: 0; } .container-94087__edge-right { right: 0; } .container-94087__edge-shadow { width: 20px; height: 100%; position: absolute; top: 0; will-change: transform; -webkit-transition: -webkit-transform 0.5s ease; transition: -webkit-transform 0.5s ease; -o-transition: transform 0.5s ease; transition: transform 0.5s ease; transition: transform 0.5s ease, -webkit-transform 0.5s ease; background: #fff; -webkit-box-shadow: 0px 0px 20px -5px rgba(0, 0, 0, 1); box-shadow: 0px 0px 20px -5px rgba(0, 0, 0, 1); } .container-94087__edge-shadow-left { left: -30px; } .container-94087__edge-shadow-right { right: -30px; } .container-94087__edge-shadow-left.visible { -webkit-transform: translateX(10px); -ms-transform: translateX(10px); transform: translateX(10px); } .container-94087__edge-shadow-right.visible { -webkit-transform: translateX(-10px); -ms-transform: translateX(-10px); transform: translateX(-10px); } .container-94087__edge-button { position: absolute; top: 50%; -webkit-transform: translateY(-50%) translateZ(0); transform: translateY(-50%) translateZ(0); will-change: transform; height: 68px; width: 44px; display: block; cursor: pointer; -webkit-transition: -webkit-transform 0.5s ease; transition: -webkit-transform 0.5s ease; -o-transition: transform 0.5s ease; transition: transform 0.5s ease; transition: transform 0.5s ease, -webkit-transform 0.5s ease; border-radius: 3px; background-color: #fff; -webkit-box-shadow: 0 0 20px 0 rgba(0,0,0,0.18); box-shadow: 0 0 20px 0 rgba(0,0,0,0.18); } .container-94087-mobile .container-94087__edge-button { display: none; } .container-94087__edge-button-left { left: -44px; } .container-94087__edge-button-left.visible { -webkit-transform: translateY(-50%) translateX(100%) translateX(20px); -ms-transform: translateY(-50%) translateX(100%) translateX(20px); transform: translateY(-50%) translateX(100%) translateX(20px); } .container-94087__edge-button-right { right: -60px; } .container-94087__edge-button-right.visible { -webkit-transform: translateY(-50%) translateX(-100%) translateX(-36px); -ms-transform: translateY(-50%) translateX(-100%) translateX(-36px); transform: translateY(-50%) translateX(-100%) translateX(-36px); } .container-94087__edge-button-arrow { position: relative; } .container-94087__edge-button-arrow:after { content: ''; position: absolute; bottom: -44px; border: 9px solid transparent; } .container-94087__edge-button-arrow-left:after { left: 6px; border-right: 12px solid #000; } .container-94087__edge-button-arrow-right:after { left: 18px; border-left: 12px solid #000; } /* mobile */ .container-94087-mobile { padding-left: 16px; } @media (max-width: 480px) { .container-94087__header-logo-link { display: none; } .container-94087__header:before { content: 'Новости СМИ2'; color: #000; width: 100%; text-align: left; margin-bottom: 5px; padding-bottom: 5px; font-size: 20px; line-height: 1.2; font-weight: 500; font-family: 'Roboto', sans-serif !important; } .container-94087 .list-container { width: 5261px; } .container-94087 .list-container-item { width: 245px; margin-right: 19px; } .container-94087__frame-wrap { height: 327px; } .container-94087__frame { height: 350px; } .container-94087__img-link { height: 307px; } .container-94087__img { min-height: 77% !important; } }</style>";var cb=function(){/** * Идентификатор блока * * @type {number} */ var block_id = 94087; /** * FIX: Первый вызов функции сохраняет innerHTML блока в глобальную * переменную window.jsApiBlockCode, второй вызов берет сохраненный * HTML и вставляет в блок #unit_<id>. Это патч работы jsapi загрузчика. */ if (!window.jsApiBlockCode) { window.jsApiBlockCode = {}; } if (!window.jsApiBlockCode[block_id]) { window.jsApiBlockCode[block_id] = document.getElementById("unit_" + block_id).innerHTML; } else { document.getElementById("unit_" + block_id).innerHTML = window.jsApiBlockCode[block_id]; } /** * Размер страницы (количество) загружаемых элементов * * @type {number} */ var page_size = 40; /** * Максимальное количество загружаемых страниц элементов * * @type {number} */ var max_page_count = 1; /** * Родительский элемент контейнера * * @type {HTMLElement} */ var parent_element = JsAPI.Dom.getElement("container-94087"); /** FIX: Данный блок 4 раза загружается на 1 странице - все данные попадают * в первый блок (id=container-87540), я удаляю id у первого чтобы второй скрипт брал * второй div[id=container-87540] и т.д. со вторым, третьим... **/ parent_element.id = null; parent_element.parentNode.parentNode.parentNode.parentNode.id = null; /** * Настройки блока * * @type {*} */ var properties = undefined; /** * Callback-функция рендера содержимого элемента * * @type {function(HTMLElement, *, number)} */ var item_content_renderer = function (parent, model, index) { var el; JsAPI.Dom.appendChild(parent, el = JsAPI.Dom.createDom('div','list-container-item', JsAPI.Dom.createDom('a', { 'class': 'container-94087__img-link', 'href': model['url'], 'target': '_blank' }, [ JsAPI.Dom.createDom('div', { 'class': 'container-94087__img', 'style': 'background-image: url(' + model['image'] + ')' }), JsAPI.Dom.createDom('div','container-94087__text', [ JsAPI.Dom.createDom('div', 'container-94087__gradient'), JsAPI.Dom.createDom('div', 'container-94087__title-wrap', JsAPI.Dom.createDom('div', 'container-94087__title', model['title'] )), ]) ]))); JsAPI.Viewability.observe(el, model['viewability'], function (data) { JsAPI.Dao.enqueueViewability(data); }); }; /** * Идентификатор блока * * @type {number} */ var block_id = 94087; /** * Маска требуемых параметров (полей) статей * * @type {number|undefined} */ var opt_fields = JsAPI.Dao.NewsField.TITLE | JsAPI.Dao.NewsField.IMAGE; var getRandomItem = function(items, result) { while(true) { var index = Math.floor((items.length) * Math.random()); var element = items[index]; if (result.indexOf(element) != -1) { continue; } return element; } }; /** * Создание list-блока */ JsAPI.Dao.getNews({ 'count': page_size, 'block_id': block_id, 'filter_news': [1], 'fields': opt_fields }, function (items) { var models = []; for (var i = 0; i < 20 && i < items.length; i++) { models.push(getRandomItem(items, models)); } models.forEach(function(model, index) { item_content_renderer(parent_element, model, index); }); var frame = parent_element.parentNode; var frameWrap = parent_element.parentNode.parentNode; var list = frameWrap.querySelector('.list-container'); var items = frameWrap.querySelectorAll('.list-container-item'); var buttonLeft = frameWrap.querySelector('.container-94087__edge-button-left'); var buttonRight = frameWrap.querySelector('.container-94087__edge-button-right'); var shadowLeft = frameWrap.querySelector('.container-94087__edge-shadow-left'); var shadowRight = frameWrap.querySelector('.container-94087__edge-shadow-right'); var block = frameWrap.parentNode; if(navigator.userAgent.match(/(iPhone|iPod|iPad|Android|playbook|silk|BlackBerry|BB10|Windows Phone|Tizen|Bada|webOS|IEMobile|Opera Mini|Symbian|HTC_|Fennec|WP7|WP8)/i)) { block.classList.add('container-94087-mobile'); } /* габариты слайдера */ var dimensions; /** максимальная позиция слайдера */ var maxPosition; /* ширина видимой области */ var frameWidth; /* расстояние на которое прокрутить слайдер */ var distance; /* оставшееся расстояние до конца после последней прокрутки */ var remains; /* текущая позиция слайдера */ var position = 0; var isGetCoords = true; function getCoords() { dimensions = frameWrap.getBoundingClientRect(); frameWidth = Math.round(parseFloat(getComputedStyle(frame).width)); maxPosition = parseInt(getComputedStyle(list).width) - frameWidth; } function calculateDistance() { var marginRight = parseInt(getComputedStyle(items[0]).marginRight); var itemWidth = items[0].offsetWidth + marginRight; var listWidth = list.offsetWidth; maxPosition = listWidth - frameWidth; distance = Math.floor(frameWidth / itemWidth) * itemWidth; remains = maxPosition - Math.floor((maxPosition / distance)) * distance; } function next() { position -= distance; if(Math.abs(position) >= maxPosition) { position = -maxPosition; } list.style.transform = 'translate3d(' + position +'px, 0, 0)'; } function prev() { if(Math.abs(position) == maxPosition) { position += remains; } else { position += distance; } if(position >= 0) { position = 0; } list.style.transform = 'translate3d(' + position +'px, 0, 0)'; } function toogleEdges(value) { if (value == 0 ) { buttonLeft.classList.remove('visible'); } if (value > 0 ) { shadowLeft.classList.add('visible'); } else { shadowLeft.classList.remove('visible'); } if (value < maxPosition) { shadowRight.classList.add('visible'); } else { shadowRight.classList.remove('visible'); buttonRight.classList.remove('visible'); } } function getAverageRGB(imgEl) { var blockSize = 5, /* only visit every 5 pixels */ defaultRGB = {r:38,g:38,b:38}, /* for non-supporting envs */ canvas = document.createElement('canvas'), context = canvas.getContext && canvas.getContext('2d'), data, width, height, i = -4, length, rgb = {r:0,g:0,b:0}, count = 0; if (!context) { return defaultRGB; } height = canvas.height = imgEl.naturalHeight || imgEl.offsetHeight || imgEl.height; width = canvas.width = imgEl.naturalWidth || imgEl.offsetWidth || imgEl.width; context.drawImage(imgEl, 0, 0); try { data = context.getImageData(0, 0, width, height); } catch(e) { /* security error, img on diff domain */ return defaultRGB; } length = data.data.length; while ( (i += blockSize * 4) < length ) { ++count; rgb.r += data.data[i]; rgb.g += data.data[i+1]; rgb.b += data.data[i+2]; } /* ~~ used to floor values */ rgb.r = ~~(rgb.r/count); rgb.g = ~~(rgb.g/count); rgb.b = ~~(rgb.b/count); return rgb; } function getLightness(r, g, b) { var lightness; var rx = r / 255; var gx = g / 255; var bx = b / 255; if(Math.max(rx, gx, bx) == Math.min(rx, gx, bx)) { lightness = Math.max(rx, gx, bx); } else { lightness = (Math.max(rx, gx, bx) + Math.min(rx, gx, bx)) / 2; } return Math.round(lightness * 100); } function clearURL(url) { var start = url.indexOf('//'); var end = url.indexOf('"\)'); return url.substring(start, end); } function fillBackground() { for(var i = 0; i < items.length; i++) { var url = clearURL(items[i].querySelector('.container-94087__img').style.backgroundImage); var image = new Image(); image.crossOrigin = 'anonymous'; var load = (function(i, image) { return function() { var rgb = getAverageRGB(image); var gradient = items[i].querySelector('.container-94087__gradient'); gradient.style.background = 'linear-gradient(to top, rgba('+rgb.r+','+rgb.g+','+rgb.b+',1) 0%, rgba(0, 0, 0, 0) 100%)'; var title = items[i].querySelector('.container-94087__title-wrap'); title.style.backgroundColor = 'rgb('+rgb.r+','+rgb.g+','+rgb.b+')'; var fontColor = getLightness(rgb.r, rgb.g, rgb.b) > 50 ? '#000' : '#fff'; title.childNodes[0].style.color = fontColor; /* Установка высоты картинки */ var imageElem = items[i].querySelector('.container-94087__img'); var titleHeight = Math.floor(title.offsetHeight * 100 / items[i].offsetHeight); var imageHeight = 100 - titleHeight; imageElem.style.height = imageHeight + '%'; } })(i, image); image.onload = load; image.src = url; } } frameWrap.addEventListener('mousemove', function(e) { if (isGetCoords) { getCoords(); isGetCoords = false; } if (e.pageX >= Math.floor(dimensions.left) && e.pageX <= Math.floor(dimensions.left) + frameWidth / 2) { /* левая половина */ if (Math.abs(position) != 0) { buttonRight.classList.remove('visible'); buttonLeft.classList.add('visible'); } } else { /* правая половина */ if (Math.abs(position) != maxPosition) { buttonLeft.classList.remove('visible'); buttonRight.classList.add('visible'); } } }); frameWrap.addEventListener('mouseleave', function (e) { buttonRight.classList.remove('visible'); buttonLeft.classList.remove('visible'); }); frame.addEventListener('scroll', function () { toogleEdges(frame.scrollLeft); }); buttonRight.addEventListener('click', next); buttonLeft.addEventListener('click', prev); buttonRight.addEventListener('click', function() { toogleEdges(Math.abs(position)); }); buttonLeft.addEventListener('click', function() { toogleEdges(Math.abs(position)); }); window.addEventListener('resize', getCoords); window.addEventListener('resize', calculateDistance); getCoords(); calculateDistance(); fillBackground(); }, function (reason) {});};if(!window.jsapi){window.jsapi=[];_jsload("//static.smi2.net/static/jsapi/jsapi.v3.5.0.ru_RU.js");}window.jsapi.push(cb);}());(function(){ window.ttsmi2_data={blockid:94087,siteid:36993};if(!window.smi2TrackerSend){window.smi2TrackerSend={};var a=window.ttsmi2_data||{};a.bw=window.innerWidth;a.bh=window.innerHeight;var b=document.referrer;b&&""!=b&&(a.ref=b);a.rnd=Math.floor(1E13*Math.random());var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(encodeURIComponent(d)+"="+encodeURIComponent(a[d]));var e=new Image;e.width=1;e.height=1;e.src="//target.smi2.ru/init/?"+c.join("&")}; })();/* StatMedia */(function(w,d,c){(w[c]=w[c]||[]).push(function(){try{w.statmedia36993=new StatMedia({"id":36993,"user_id":"9b00c196-fd60-4327-bf84-d13c232d511b","user_datetime":1604063195219,"session_id":"b6d7f568-c0cf-44d4-92ad-a12ddd1800ec"});}catch(e){}});if(!window.__statmedia){var p=d.createElement('script');p.type='text/javascript';p.async=true;p.src='https://stat.media/sm.js';var s=d.getElementsByTagName('script')[0];s.parentNode.insertBefore(p,s);}})(window,document,'__statmedia_callbacks');/* /StatMedia */